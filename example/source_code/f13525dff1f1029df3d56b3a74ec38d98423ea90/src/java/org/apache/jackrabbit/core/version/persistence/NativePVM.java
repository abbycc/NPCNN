org apach jackrabbit core version persist
org apach common collect refer map referencemap
org apach jackrabbit core
org apach jackrabbit core observ observ manag impl observationmanagerimpl
org apach jackrabbit core nodetyp node type registri nodetyperegistri
org apach jackrabbit core state
org apach jackrabbit core util uuid uuid
org apach jackrabbit core version intern version internalvers
org apach jackrabbit core version intern version histori internalversionhistori
org apach jackrabbit core version intern version item internalversionitem
org apach jackrabbit core version persist version manag persistentversionmanag
org apach log4j logger
javax jcr repositori except repositoryexcept
javax jcr
java util hash map hashmap
java util iter
java util map
class implement persist part version
current implement 'normal' repositori content storag
node map virtual real content
persist node structur expos
version element version histori version freez store
persist node state origin uuid
persistentnodest repres version uuid version
hierarchi similar histori version
frozen node
startup entir structur travers order map
real persist uuid
todo persist synchron lead multi thread issu
nativ pvm nativepvm persist version manag persistentversionmanag constant
logger
logger log logger logger getlogg nativ pvm nativepvm
root path version storag
qname version histori root version histori root qname jcr uri jcr uri persistentversionstorag
'jcr historyid' properti
qname propnam histori propnam histori qname jcr uri jcr uri historyid
'jcr versionableid' properti
qname propnam version propnam version qname jcr uri jcr uri versionableid
'jcr versionid' properti
qname propnam version propnam version qname jcr uri jcr uri versionid
'jcr versionname' properti
qname propnam version propnam version qname jcr uri jcr uri versionnam
'jcr versionlabels' node
qname nodenam version label nodenam version label qname jcr uri jcr uri versionlabel
'jcr name' properti
qname propnam propnam qname jcr uri jcr uri
'jcr version' properti
qname propnam version propnam version qname jcr uri jcr uri version
persisten root node
node nodeid persist root persist root node nodeid facefac ab3b 48a9 b31b e7d0a9c1c3b1
nodetyp persist version
qname rep version rep version qname rep uri rep uri version
nodetyp presist version histori
qname rep version histori rep version histori qname rep uri rep uri versionhistori
nodetyp persist frozen node
qname rep frozen rep frozen qname rep uri rep uri frozen
nodetyp persist frozen histori
qname rep frozen histori rep frozen histori qname rep uri rep uri frozenversionhistori
persist root node version histori
persist node persistentnod histori root historyroot
state manag version storag
local item state manag localitemstatemanag state mgr statemgr
persist manag
persist manag persistencemanag mgr pmgr
map virtual uuid persist id persist node
kei externalid persistentid
hash map hashmap id extern idsbyextern hash map hashmap
map virtual uuid persist id persist node
kei internalid persistentid
hash map hashmap id intern idsbyintern hash map hashmap
map version uuid kei versioneduuid externalid
hash map hashmap version uui versioneduuid hash map hashmap
version histori kei uuid version histori
map item refer map referencemap refer map referencemap hard refer map referencemap soft
creat nativepvm
param pmgr
param ntreg
throw javax jcr repositoryexcept
nativ pvm nativepvm persist manag persistencemanag mgr pmgr node type registri nodetyperegistri reg ntreg repositori except repositoryexcept
system current time milli currenttimemilli
statemgr nativeitemstatemanag pmgr persist root getuuid ntreg
mgr pmgr mgr pmgr
share item state manag shareditemstatemanag share state mgr sharedstatemgr share item state manag shareditemstatemanag mgr pmgr persist root persist root uuid getuuid reg ntreg
todo version attach workspac trigger observ
state mgr statemgr local item state manag localitemstatemanag share state mgr sharedstatemgr
node state nodest node state nodest node state nodest state mgr statemgr item state getitemst persist root persist root
histori root historyroot persist node persistentnod state mgr statemgr node state nodest
init virtual id initvirtualid histori root historyroot state getstat
system current time milli currenttimemilli
log info load id extern idsbyextern size virtual id
item state except itemstateexcept
repositori except repositoryexcept unabl initi persistentversionmanag string tostr
close persist version manag close persist
manag oper object treat illeg
throw
throw except error occur
close except
todo check proper shutdown sequenc
mgr pmgr close
state mgr statemgr
initi intern item id
param parent
throw repositoryexcept
throw itemstateexcept
init virtual id initvirtualid node state nodest parent
repositori except repositoryexcept item state except itemstateexcept
iter iter parent child node entri getchildnodeentri iter
iter hasnext
node state nodest child node entri childnodeentri entri node state nodest child node entri childnodeentri iter
string real uuid realuuid entri getnam local getlocalnam
init virtual id initvirtualid real uuid realuuid node state nodest state mgr statemgr item state getitemst node nodeid entri uuid getuuid
initi intern item id
param realuuid
param state
throw itemstateexcept
throw repositoryexcept
init virtual id initvirtualid string real uuid realuuid node state nodest state
item state except itemstateexcept repositori except repositoryexcept
persist persistentid persist persistentid real uuid realuuid state
type persist persistentid type undefin type undefin
id extern idsbyextern
id extern idsbyextern put extern externalid
id intern idsbyintern put intern internalid
type persist persistentid type histori type histori
retriev version uuid order avoid collis
properti state propertyst properti state propertyst state mgr statemgr item state getitemst properti propertyid state uuid getuuid propnam version propnam version
string vid string valu getvalu intern internalvalu
version uui versioneduuid put vid extern externalid
init virtual id initvirtualid state
return persistentid extern uuid
param uuid
return
persist persistentid extern getidbyextern string uuid
id extern idsbyextern
persist persistentid id extern idsbyextern uuid
return persustentid intern uuid
param uuid
return
persist persistentid intern getidbyintern string uuid
persist persistentid id intern idsbyintern uuid
return persustentid give intern uuid item type
param uuid
param type
return
persist persistentid extern getidbyextern string uuid type
id extern idsbyextern
persist persistentid persist persistentid id extern idsbyextern uuid
type type
retrusn version histori correspond version node
uuid
param uuid
return
intern version histori impl internalversionhistoryimpl histori version uuid gethistorybyversionableuuid string uuid
repositori except repositoryexcept
string extern externalid string version uui versioneduuid uuid
extern externalid intern version histori impl internalversionhistoryimpl version histori getversionhistori extern externalid
creat version histori
param node node version histori initi
return newli creat version histori
throw repositoryexcept
intern version histori internalversionhistori creat version histori createversionhistori node impl nodeimpl node
repositori except repositoryexcept
check version histori node exist
intern version histori impl internalversionhistoryimpl hist histori version uuid gethistorybyversionableuuid node intern uuid internalgetuuid
hist
hist
state mgr statemgr edit
creat deep path
string uuid uuid random uuid randomuuid string tostr
persist node persistentnod root histori root historyroot
qname qname default uri default uri uuid substr
root node hasnod
root add node addnod unstructur unstructur
root store
root root node getnod
qname histori node historynodenam qname default uri default uri uuid
creat histori node persist state
hist intern version histori impl internalversionhistoryimpl creat root uuid histori node historynodenam node
end updat
state mgr statemgr updat
init virtual id initvirtualid hist getid hist node getnod state getstat
item state except itemstateexcept
repositori except repositoryexcept
log info creat version histori hist getid node safe jcr path safegetjcrpath numhistori version uui versioneduuid size
hist
return intern version histori
param histid histori
return
throw repositoryexcept
intern version histori internalversionhistori version histori getversionhistori string hist histid
repositori except repositoryexcept
persist persistentid pid extern getidbyextern hist histid persist persistentid type histori type histori
pid intern version histori internalversionhistori item getitem pid
check versionhistori exist
param histid
return
version histori hasversionhistori string hist histid
extern getidbyextern hist histid persist persistentid type histori type histori
return iter extern id version histori
return
throw repositoryexcept
iter version histori id getversionhistoryid repositori except repositoryexcept
version uui versioneduuid valu iter
return number version histori
return
throw repositoryexcept
num version histori getnumversionhistori repositori except repositoryexcept
version uui versioneduuid size
return intern version
param versionid
return
throw repositoryexcept
intern version internalvers version getvers string hist histid string version versionid
repositori except repositoryexcept
intern version histori internalversionhistori histori version histori getversionhistori hist histid
histori version getvers version versionid
return version
param versionid
return
throw repositoryexcept
intern version internalvers version getvers string version versionid
repositori except repositoryexcept
persist persistentid pid extern getidbyextern version versionid persist persistentid type version type version
pid intern version internalvers item getitem pid
check version exist
param versionid
return
version hasvers string version versionid
extern getidbyextern version versionid persist persistentid type version type version
check item extern exist
param externalid
return
item hasitem string extern externalid
extern getidbyextern extern externalid
return item refer extern
param externalid
return
throw repositoryexcept
intern version item internalversionitem item extern getitembyextern string extern externalid
repositori except repositoryexcept
persist persistentid pid extern getidbyextern extern externalid
pid item getitem pid
return item refer intern
param internalid
return
throw repositoryexcept
intern version item internalversionitem item intern getitembyintern string intern internalid
repositori except repositoryexcept
persist persistentid pid intern getidbyintern intern internalid
pid item getitem pid
return item persist
param pid
return
throw repositoryexcept
intern version item internalversionitem item getitem persist persistentid pid
repositori except repositoryexcept
intern version item internalversionitem item intern version item internalversionitem item pid
item
persist node persistentnod node pnode histori root historyroot node uuid getnodebyuuid pid intern internalid
node pnode
intern version item internalversionitem parent item intern getitembyintern node pnode parent uuid getparentuuid
pid type persist persistentid type frozen type frozen
item intern frozen node impl internalfrozennodeimpl node pnode pid extern externalid parent
pid type persist persistentid type frozen histori type frozen histori
item intern frozen impl internalfrozenvhimpl node pnode pid extern externalid parent
pid type persist persistentid type version type version
item intern version histori internalversionhistori parent version getvers pid extern externalid
pid type persist persistentid type histori type histori
item intern version histori impl internalversionhistoryimpl node pnode
return null
item
item put pid item
item
check node
param node
return
throw repositoryexcept
javax jcr node checkin
intern version internalvers checkin node impl nodeimpl node repositori except repositoryexcept
assum node version checkout check nodeimpl
creat version version node client call checkin
seri event
string hist uuid histuuid node properti getproperti constant jcr versionhistori jcr versionhistori string getstr
intern version histori impl internalversionhistoryimpl histori intern version histori impl internalversionhistoryimpl version histori getversionhistori hist uuid histuuid
resolv predecessor
valu node properti getproperti constant jcr predecessor jcr predecessor valu getvalu
intern version internalvers pred intern version internalvers valu length
valu length
pred histori version getvers valu string getstr
search predecessor suitabl gener
string version versionnam
max dot maxdot integ max max
pred length
pred successor
pred successor getsuccessor length
version versionnam pred getnam local getlocalnam versionnam pred getnam getlocalnam assum namespac version name
count dot
po
num dot numdot
version versionnam index indexof po
po version versionnam index indexof po
num dot numdot
num dot numdot max dot maxdot
max dot maxdot num dot numdot
version versionnam po version versionnam substr po integ pars int parseint version versionnam substr po
empti found gener
version versionnam
version versionnam pred getnam local getlocalnam
version versionnam
histori version hasvers qname version versionnam
state mgr statemgr edit
intern version impl internalversionimpl histori checkin qname version versionnam node
state mgr statemgr updat
init virtual id initvirtualid getid node getnod state getstat
item state except itemstateexcept
repositori except repositoryexcept
persistentversionmanag getitemstatemgr
updat item state manag updatableitemstatemanag item state mgr getitemstatemgr
state mgr statemgr
helper class persist item
persist persistentid
type undefin type undefin
type histori type histori
type version type version
type frozen type frozen
type frozen histori type frozen histori
type persist node
type
persist uuid node
string extern externalid
persist uuid node
string intern internalid
persist persistentid type string extern string intern
type type
intern internalid intern
extern externalid extern
persist persistentid string extern node state nodest state
intern internalid state uuid getuuid
state node type getnodetypenam equal rep version rep version
extern externalid extern
type type version type version
state node type getnodetypenam equal rep version histori rep version histori
extern externalid extern
type type histori type histori
state node type getnodetypenam equal rep frozen rep frozen
ignor externalid gener
extern externalid uuid random uuid randomuuid string tostr
type type frozen type frozen
state node type getnodetypenam equal rep frozen histori rep frozen histori
ignor externalid gener
extern externalid uuid random uuid randomuuid string tostr
type type frozen histori type frozen histori
ignor externalid gener
extern externalid uuid random uuid randomuuid string tostr
type type undefin type undefin
version isvers
type type version type version
histori ishistori
type type histori type histori
frozen isfrozen
type type frozen type frozen
