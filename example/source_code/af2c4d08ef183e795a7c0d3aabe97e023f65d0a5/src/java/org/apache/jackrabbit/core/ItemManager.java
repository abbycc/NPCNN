org apach jackrabbit core
org apach common collect refer map referencemap
org apach jackrabbit core nodetyp node def nodedefid
org apach jackrabbit core nodetyp node definit impl nodedefinitionimpl
org apach jackrabbit core nodetyp prop def propdefid
org apach jackrabbit core nodetyp properti definit impl propertydefinitionimpl
org apach jackrabbit core secur access manag accessmanag
org apach jackrabbit core state item state itemst
org apach jackrabbit core state item state except itemstateexcept
org apach jackrabbit core state item state manag itemstatemanag
org apach jackrabbit core state item state except nosuchitemstateexcept
org apach jackrabbit core state node state nodest
org apach jackrabbit core state properti state propertyst
org apach jackrabbit core version intern version internalvers
org apach jackrabbit core version intern version histori internalversionhistori
org apach jackrabbit core version version histori impl versionhistoryimpl
org apach jackrabbit core version version impl versionimpl
org apach log4j logger
javax jcr access deni except accessdeniedexcept
javax jcr item found except itemnotfoundexcept
javax jcr node iter nodeiter
javax jcr path found except pathnotfoundexcept
javax jcr properti iter propertyiter
javax jcr repositori except repositoryexcept
javax jcr nodetyp node definit nodedefinit
javax jcr nodetyp properti definit propertydefinit
java print stream printstream
java util arrai list arraylist
java util iter
java util map
code itemmanag code instanc code session code
instanc factori code node code code properti code
instanc
code itemmanag code respons
provid access code item code instanc code itemid code
code node code code item code provid rel access
return instanc exist code node code code properti code
absolut path
creat session instanc code node code
code properti code exist creat
guarante multipl instanc repres
code node code code properti code
code session code instanc
maintain cach item instanc creat
respect access right code session code method
parent code session code code xasess code
code itemmanag code instanc start global transact
item manag itemmanag item life cycl listen itemlifecyclelisten constant
logger log logger logger getlogg item manag itemmanag
node definit nodedefinit root node def rootnodedef
node nodeid root node rootnodeid
session impl sessionimpl session
item state manag itemstatemanag item state provid itemstateprovid
hierarchi manag hierarchymanag hier mgr hiermgr
node impl nodeimpl root
cach item instanc creat code itemmanag code
map item cach itemcach
creat session instanc code itemmanag code instanc
param itemstateprovid item state provid
instanc
param session session instanc
param rootnodedef definit root node
param rootnodeuuid uuid root node
item manag itemmanag item state manag itemstatemanag item state provid itemstateprovid hierarchi manag hierarchymanag hier mgr hiermgr
session impl sessionimpl session node definit nodedefinit root node def rootnodedef
string root node uuid rootnodeuuid
item state provid itemstateprovid item state provid itemstateprovid
hier mgr hiermgr hier mgr hiermgr
session session
root node def rootnodedef root node def rootnodedef
root node rootnodeid node nodeid root node uuid rootnodeuuid
setup item cach weak refer item
item cach itemcach refer map referencemap refer map referencemap hard refer map referencemap weak
return root node instanc repositori
return root node
throw repositoryexcept
node impl nodeimpl root getroot repositori except repositoryexcept
lazi instanti root node
avoid chicken egg kind problem
root
node state nodest root state rootstat node state nodest item state provid itemstateprovid item state getitemst root node rootnodeid
hard refer root node
root creat node instanc createnodeinst root state rootstat root node def rootnodedef
item state except itemstateexcept is
string msg fail retriev state root node
log debug msg
repositori except repositoryexcept msg is
root
dump state code itemmanag code instanc
diagnost purpos
param
throw repositoryexcept
dump print stream printstream repositori except repositoryexcept
println itemmanag
println
println item cach
println
iter iter item cach itemcach kei set keyset iter
iter hasnext
item itemid item itemid iter
item impl itemimpl item item impl itemimpl item cach itemcach
item node isnod
print node
print properti
item transient istransi
print transient
print
println item path getpath item
dispos code itemmanag code free resourc
dispos
item cach itemcach clear
node definit nodedefinit definit getdefinit node state nodest state
repositori except repositoryexcept
node def nodedefid def defid state definit getdefinitionid
node definit impl nodedefinitionimpl def session node type manag getnodetypemanag node definit getnodedefinit def defid
def
todo proper handl inconsist corrupt definit
'flag' item refer exist definit
log warn node safe jcr path safegetjcrpath state getid
invalid definitionid def defid
fallback find applic definit
node nodeid parent parentid node nodeid state parent uuid getparentuuid
node impl nodeimpl parent node impl nodeimpl item getitem parent parentid
node state nodest parent state parentst node state nodest parent item state getitemst
node state nodest child node entri childnodeentri cne node state nodest child node entri childnodeentri parent state parentst child node entri getchildnodeentri state uuid getuuid
def parent applic child node definit getapplicablechildnodedefinit cne getnam state node type getnodetypenam
state set definit setdefinitionid def unwrap getid
def
properti definit propertydefinit definit getdefinit properti state propertyst state
repositori except repositoryexcept
prop def propdefid def defid state definit getdefinitionid
properti definit impl propertydefinitionimpl def session node type manag getnodetypemanag properti definit getpropertydefinit def defid
def
todo proper handl inconsist corrupt definit
'flag' item refer exist definit
log warn properti safe jcr path safegetjcrpath state getid
invalid definitionid def defid
fallback find applic definit
node nodeid parent parentid node nodeid state parent uuid getparentuuid
node impl nodeimpl parent node impl nodeimpl item getitem parent parentid
def parent applic properti definit getapplicablepropertydefinit state getnam state type gettyp state multi valu ismultivalu
state set definit setdefinitionid def unwrap getid
def
retriev state item code code item
exist code itemnotfoundexcept code thrown
item exist current session grant read access
code accessdeniedexcept code thrown
param item retriev
return state state item
throw itemnotfoundexcept item code code exist
throw accessdeniedexcept current session allow
read item
throw repositoryexcept error occur
item state itemst item state getitemst item itemid
item found except itemnotfoundexcept access deni except accessdeniedexcept
repositori except repositoryexcept
check privileg
session access manag getaccessmanag grant isgrant access manag accessmanag read
clear cach
item impl itemimpl item retriev item retrieveitem
item
evict item evictitem
access deni except accessdeniedexcept read item
item state provid itemstateprovid item state getitemst
item state except nosuchitemstateexcept nsise
string msg item
log debug msg
item found except itemnotfoundexcept msg
item state except itemstateexcept is
string msg fail retriev item state
log error msg
repositori except repositoryexcept msg is
item access method
check item path exist
param path path item check
return true item exist
item exist itemexist path path
check saniti session
session saniti check sanitycheck
item itemid hier mgr hiermgr resolv path resolvepath path
check state exist item
item state provid itemstateprovid item state hasitemst
check privileg
session access manag getaccessmanag grant isgrant access manag accessmanag read
clear cach
cach iscach
evict item evictitem
item exist session grant read access
path found except pathnotfoundexcept pnfe
item found except itemnotfoundexcept inf
repositori except repositoryexcept
check item exist
param item check
return true item exist
item exist itemexist item itemid
check saniti session
session saniti check sanitycheck
check state exist item
item state provid itemstateprovid item state hasitemst
check privileg
session access manag getaccessmanag grant isgrant access manag accessmanag read
clear cach
cach iscach
evict item evictitem
item exist session grant read access
item found except itemnotfoundexcept inf
repositori except repositoryexcept
return
throw repositoryexcept
node impl nodeimpl root node getrootnod repositori except repositoryexcept
root getroot
param path
return
throw pathnotfoundexcept
throw accessdeniedexcept
throw repositoryexcept
item impl itemimpl item getitem path path
path found except pathnotfoundexcept access deni except accessdeniedexcept repositori except repositoryexcept
item itemid hier mgr hiermgr resolv path resolvepath path
item getitem
item found except itemnotfoundexcept inf
path found except pathnotfoundexcept safe jcr path safegetjcrpath path
param
return
throw repositoryexcept
item impl itemimpl item getitem item itemid
item found except itemnotfoundexcept access deni except accessdeniedexcept repositori except repositoryexcept
check saniti session
session saniti check sanitycheck
check privileg
session access manag getaccessmanag grant isgrant access manag accessmanag read
clear cach
cach iscach
evict item evictitem
access deni except accessdeniedexcept read item
check cach
cach iscach
retriev item retrieveitem
shortcut
denot node denotesnod equal root node rootnodeid
root getroot
creat instanc item state object
creat item instanc createiteminst
param parentid
return
throw itemnotfoundexcept
throw accessdeniedexcept
throw repositoryexcept
child node haschildnod node nodeid parent parentid
item found except itemnotfoundexcept access deni except accessdeniedexcept repositori except repositoryexcept
check saniti session
session saniti check sanitycheck
item state itemst state item state getitemst parent parentid
state node isnod
string msg list child node properti parent parentid
log debug msg
repositori except repositoryexcept msg
node state nodest node state nodest node state nodest state
iter iter node state nodest child node entri getchildnodeentri iter
iter hasnext
node state nodest child node entri childnodeentri entri node state nodest child node entri childnodeentri iter
node nodeid node nodeid entri uuid getuuid
check read access
session access manag getaccessmanag grant isgrant access manag accessmanag read
param parentid
return
throw itemnotfoundexcept
throw accessdeniedexcept
throw repositoryexcept
node iter nodeiter child node getchildnod node nodeid parent parentid
item found except itemnotfoundexcept access deni except accessdeniedexcept repositori except repositoryexcept
check saniti session
session saniti check sanitycheck
item state itemst state item state getitemst parent parentid
state node isnod
string msg list child node properti parent parentid
log debug msg
repositori except repositoryexcept msg
node state nodest node state nodest node state nodest state
arrai list arraylist child id childid arrai list arraylist
iter iter node state nodest child node entri getchildnodeentri iter
iter hasnext
node state nodest child node entri childnodeentri entri node state nodest child node entri childnodeentri iter
node nodeid node nodeid entri uuid getuuid
check read access
session access manag getaccessmanag grant isgrant access manag accessmanag read
child id childid add
lazi item iter lazyitemiter child id childid
param parentid
return
throw itemnotfoundexcept
throw accessdeniedexcept
throw repositoryexcept
child properti haschildproperti node nodeid parent parentid
item found except itemnotfoundexcept access deni except accessdeniedexcept repositori except repositoryexcept
check saniti session
session saniti check sanitycheck
item state itemst state item state getitemst parent parentid
state node isnod
string msg list child properti properti parent parentid
log debug msg
repositori except repositoryexcept msg
node state nodest node state nodest node state nodest state
iter iter node state nodest properti entri getpropertyentri iter
iter hasnext
node state nodest properti entri propertyentri entri node state nodest properti entri propertyentri iter
properti propertyid properti propertyid parent parentid uuid getuuid entri getnam
check read access
session access manag getaccessmanag grant isgrant access manag accessmanag read
param parentid
return
throw itemnotfoundexcept
throw accessdeniedexcept
throw repositoryexcept
properti iter propertyiter child properti getchildproperti node nodeid parent parentid
item found except itemnotfoundexcept access deni except accessdeniedexcept repositori except repositoryexcept
check saniti session
session saniti check sanitycheck
item state itemst state item state getitemst parent parentid
state node isnod
string msg list child properti properti parent parentid
log debug msg
repositori except repositoryexcept msg
node state nodest node state nodest node state nodest state
arrai list arraylist child id childid arrai list arraylist
iter iter node state nodest properti entri getpropertyentri iter
iter hasnext
node state nodest properti entri propertyentri entri node state nodest properti entri propertyentri iter
properti propertyid properti propertyid parent parentid uuid getuuid entri getnam
check read access
session access manag getaccessmanag grant isgrant access manag accessmanag read
child id childid add
lazi item iter lazyitemiter child id childid
item factori method
item impl itemimpl creat item instanc createiteminst item itemid
item found except itemnotfoundexcept repositori except repositoryexcept
creat instanc item state object
item impl itemimpl item
item state itemst state
state item state provid itemstateprovid item state getitemst
item state except nosuchitemstateexcept nsise
item found except itemnotfoundexcept string tostr
item state except itemstateexcept is
string msg fail retriev item state item
log error msg is
repositori except repositoryexcept msg is
state node isnod
item creat node instanc createnodeinst node state nodest state
item creat properti instanc createpropertyinst properti state propertyst state
item
node impl nodeimpl creat node instanc createnodeinst node state nodest state node definit nodedefinit def
repositori except repositoryexcept
node nodeid node nodeid state uuid getuuid
inform life cycl node object
order maintain item cach consist
item life cycl listen itemlifecyclelisten listen item life cycl listen itemlifecyclelisten
check special node
state node type getnodetypenam equal version version
intern version internalvers version
session version manag getversionmanag version getvers state uuid getuuid
version impl versionimpl session state def listen version
state node type getnodetypenam equal versionhistori versionhistori
intern version histori internalversionhistori histori
session version manag getversionmanag version histori getversionhistori state uuid getuuid
version histori impl versionhistoryimpl session state def listen histori
creat node object
node impl nodeimpl session state def listen
node impl nodeimpl creat node instanc createnodeinst node state nodest state repositori except repositoryexcept
definit node
node definit nodedefinit def definit getdefinit state
creat instanc
creat node instanc createnodeinst state def
properti impl propertyimpl creat properti instanc createpropertyinst properti state propertyst state
properti definit propertydefinit def
properti propertyid properti propertyid state parent uuid getparentuuid state getnam
inform life cycl properti object
order maintain item cach consist
item life cycl listen itemlifecyclelisten listen item life cycl listen itemlifecyclelisten
creat properti object
properti impl propertyimpl prop properti impl propertyimpl session state def listen
prop
properti impl propertyimpl creat properti instanc createpropertyinst properti state propertyst state
repositori except repositoryexcept
definit properti
properti definit propertydefinit def definit getdefinit state
creat instanc
creat properti instanc createpropertyinst state def
item cach method
check cach entri
param check
return true cach entri fals
cach iscach item itemid
item cach itemcach kei containskei
return item refer cach
param item retriev
return item refer store cach entri
code null code cach entri
item impl itemimpl retriev item retrieveitem item itemid
item impl itemimpl item cach itemcach
put refer item cach
item' path kei
param item item cach
cach item cacheitem item impl itemimpl item
item itemid item getid
item cach itemcach kei containskei
log warn overwrit cach item
log debug enabl isdebugen
log debug cach item
item cach itemcach put item
remov cach entri specif item
param item remov cach
evict item evictitem item itemid
log debug enabl isdebugen
log debug remov item cach
item cach itemcach remov
misc helper method
failsaf convers intern code path code jcr path
error messag
param path path convert
return jcr path
string safe jcr path safegetjcrpath path path
path jcr path tojcrpath session namespac resolv getnamespaceresolv
prefix declar except noprefixdeclaredexcept npde
log error fail convert path string tostr jcr path
return string represent intern path fallback
path string tostr
failsaf translat intern code itemid code jcr path
error messag
param path convert
return jcr path
string safe jcr path safegetjcrpath item itemid
safe jcr path safegetjcrpath hier mgr hiermgr path getpath
repositori except repositoryexcept
log error fail determin path
return string represent fallback
string tostr
itemlifecyclelisten
inheritdoc
item creat itemcr item impl itemimpl item
log debug enabl isdebugen
log debug creat item item getid
add instanc cach
cach item cacheitem item
inheritdoc
item invalid iteminvalid item itemid item impl itemimpl item
log debug enabl isdebugen
log debug invalid item
remov instanc cach
evict item evictitem
inheritdoc
item destroi itemdestroi item itemid item impl itemimpl item
log debug enabl isdebugen
log debug destroi item
longer interest item
item remov life cycl listen removelifecyclelisten
remov instanc cach
evict item evictitem
