org apach jackrabbit core data
java file
java file output stream fileoutputstream
java except ioexcept
java input stream inputstream
java output stream outputstream
java lang ref weak refer weakrefer
java secur digest output stream digestoutputstream
java secur messag digest messagedigest
java secur algorithm except nosuchalgorithmexcept
java sql timestamp
java util arrai list arraylist
java util collect
java util iter
java util list
java util map
java util weak hash map weakhashmap
org apach common util ioutil
org slf4j logger
org slf4j logger factori loggerfactori
simpl file base data store data record store normal file
name messag digest contain binari stream
configur
pre
datastor class org apach jackrabbit core data filedatastor
param link setpath string path data datastor
param link setminrecordlength int minrecordlength
datastor
pre
directori set directori repositori home repositori datastor
level directori structur avoid place
file singl directori chosen structur design scale
billion distinct record
implement reli underli file system support
atom move oper link file renameto file
file data store filedatastor data store datastor
logger instanc
logger log logger factori loggerfactori logger getlogg file data store filedatastor
digest algorithm uniqu identifi record
string digest sha
default minimum object size
default min record length default min record length
maximum modifi time resolut file system
access time resolut access time resolut
directori temporari file
charact
string tmp tmp
minimum modifi date file access read write modifi date
older modifi date updat current time
min modifi date minmodifiedd
directori data record file structur
content directori control class
file directori
directori data record file structur
content directori control class
string path
minimum size object store data store
min record length minrecordlength default min record length default min record length
data identifi set garbag collect
map data identifi dataidentifi weak refer weakrefer data identifi dataidentifi inus
collect synchron map synchronizedmap weak hash map weakhashmap data identifi dataidentifi weak refer weakrefer data identifi dataidentifi
initi data store
path set repositori home repositori datastor
directori automat creat exist
param homedir
init string home dir homedir
path
path home dir homedir repositori datastor
directori file path
directori mkdir
data record datarecord record store getrecordifstor data identifi dataidentifi identifi data store except datastoreexcept
record getrecord identifi
data record identifi
method check file exist verifi flag set
verifi flag set file exist method return null
param identifi identifi
param verifi check file exist
return data record null
data record datarecord record getrecord data identifi dataidentifi identifi verifi data store except datastoreexcept
file file file getfil identifi
verifi file exist
min modifi date minmodifiedd
check run garbag collect
modifi lastmodifi file modifi lastmodifi
modifi lastmodifi
data store except datastoreexcept fail read record modifi date identifi
modifi lastmodifi min modifi date minmodifiedd
case write file system
call file canwrit earlier save system call
file write canwrit
current approach depend call succeed
file set modifi setlastmodifi system current time milli currenttimemilli access time resolut access time resolut
data store except datastoreexcept fail updat record modifi date identifi
identifi usesidentifi identifi
file data record filedatarecord identifi file
return record identifi note method
perform saniti check identifi
caller ensur identifi previous creat data
record
param identifi data identifi
return identifi data record
data record datarecord record getrecord data identifi dataidentifi identifi data store except datastoreexcept
record getrecord identifi
identifi usesidentifi data identifi dataidentifi identifi
inus put identifi weak refer weakrefer data identifi dataidentifi identifi
creat data record
stream consum content save temporari file
sha messag digest stream calcul
record sha digest length found
return temporari file move place
data record return
param input binari stream
return data record stream
throw datastoreexcept record creat
data record datarecord add record addrecord input stream inputstream input data store except datastoreexcept
file temporari
temporari temporari file newtemporaryfil
data identifi dataidentifi temp tempid data identifi dataidentifi temporari getnam
identifi usesidentifi temp tempid
copi stream temporari file calcul
stream length messag digest stream
length
messag digest messagedigest digest messag digest messagedigest instanc getinst digest
output stream outputstream output digest output stream digestoutputstream
file output stream fileoutputstream temporari digest
length util ioutil copi larg copylarg input output
output close
data identifi dataidentifi identifi data identifi dataidentifi digest digest
file file
check record exist
move temporari file place need
identifi usesidentifi identifi
file file getfil identifi
file exist
file parent file parent file getparentfil
parent mkdir
temporari renam renameto file
longer delet temporari file
temporari
except ioexcept
renam temporari absolut path getabsolutepath
file absolut path getabsolutepath
media read
modifi lastmodifi file modifi lastmodifi
modifi lastmodifi
data store except datastoreexcept fail read record modifi date identifi
system current time milli currenttimemilli
modifi lastmodifi access time resolut access time resolut
current approach depend call succeed writabl file
file set modifi setlastmodifi access time resolut access time resolut
file write canwrit
data store except datastoreexcept fail updat record modifi date identifi
file length length
saniti check record file fail
safe
file file isfil
except ioexcept file file
except ioexcept digest collis file
make
tempid garbag collect
inus remov temp tempid
file data record filedatarecord identifi file
algorithm except nosuchalgorithmexcept
data store except datastoreexcept digest
except ioexcept
data store except datastoreexcept add record
temporari
temporari delet
return identifi file method implement pattern
avoid problem file singl directori
saniti check perform identifi
param identifi data identifi
return identifi file
file file getfil data identifi dataidentifi identifi
identifi usesidentifi identifi
string string identifi string tostr
file file directori
file file file string substr
file file file string substr
file file file string substr
file file string
return uniqu temporari file creat
data record
return temporari file
throw ioexcept
file temporari file newtemporaryfil except ioexcept
directori creat init method
file creat temp file createtempfil tmp directori
updat modifi date access updatemodifieddateonaccess
min modifi date minmodifiedd
delet older deleteallolderthan min
delet older recurs deleteolderrecurs directori min
delet older recurs deleteolderrecurs file file min
count
file file isfil file exist file write canwrit
modifi lastmodifi file modifi lastmodifi
modifi lastmodifi
delet file lastmodifi date uncertain
log warn fail read modif date file absolut path getabsolutepath
modifi lastmodifi min
data identifi dataidentifi data identifi dataidentifi file getnam
inus kei containskei
log info enabl isinfoen
log info delet file file absolut path getabsolutepath
modifi timestamp modifi lastmodifi string tostr
length file length
file delet
log warn fail delet file file absolut path getabsolutepath
count
file directori isdirectori
file file list file listfil
count delet older recurs deleteolderrecurs min
jcr filedatastor garbag collector empti directori
automat remov empti directori root
file directori file list length
file delet
count
list recurs listrecurs list file list file file
file file file list file listfil
file
file file
directori isdirectori
list recurs listrecurs list
list add
iter data identifi dataidentifi identifi getallidentifi
arrai list arraylist file file arrai list arraylist file
list recurs listrecurs file directori
arrai list arraylist data identifi dataidentifi identifi arrai list arraylist data identifi dataidentifi
file file
string getnam
start startswith tmp
data identifi dataidentifi data identifi dataidentifi
identifi add
identifi iter
clear clearinus
inus clear
directori data store file
return full path
string path getpath
path
set directori data store file
param directorynam path
set path setpath string directori directorynam
path directori directorynam
min record length getminrecordlength
min record length minrecordlength
set minimum object length
param minrecordlength length
set min record length setminrecordlength min record length minrecordlength
min record length minrecordlength min record length minrecordlength
close
