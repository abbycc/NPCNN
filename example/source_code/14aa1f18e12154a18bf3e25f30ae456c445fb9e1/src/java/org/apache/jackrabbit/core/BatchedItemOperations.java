org apach jackrabbit core
org apach jackrabbit core lock lock manag lockmanag
org apach jackrabbit core nodetyp effect node type effectivenodetyp
org apach jackrabbit core nodetyp node def nodedef
org apach jackrabbit core nodetyp node type registri nodetyperegistri
org apach jackrabbit core nodetyp prop def propdef
org apach jackrabbit core nodetyp prop def propdefid
org apach jackrabbit core secur access manag accessmanag
org apach jackrabbit core state item state itemst
org apach jackrabbit core state item state except itemstateexcept
org apach jackrabbit core state item state manag itemstatemanag
org apach jackrabbit core state item state except nosuchitemstateexcept
org apach jackrabbit core state node refer noderefer
org apach jackrabbit core state node refer nodereferencesid
org apach jackrabbit core state node state nodest
org apach jackrabbit core state properti state propertyst
org apach jackrabbit core state updat item state manag updatableitemstatemanag
org apach jackrabbit core util refer chang tracker referencechangetrack
org apach jackrabbit core util uuid uuid
org apach jackrabbit core intern internalvalu
org apach log4j logger
javax jcr access deni except accessdeniedexcept
javax jcr item exist except itemexistsexcept
javax jcr item found except itemnotfoundexcept
javax jcr path found except pathnotfoundexcept
javax jcr properti type propertytyp
javax jcr referenti integr except referentialintegrityexcept
javax jcr repositori except repositoryexcept
javax jcr lock lock except lockexcept
javax jcr nodetyp constraint violat except constraintviolationexcept
javax jcr version version except versionexcept
java util arrai list arraylist
java util arrai
java util calendar
java util hash set hashset
java util iter
java util list
java util set
code batcheditemoper code intern helper class
high low level oper directli
code itemst code level
batch item oper batcheditemoper item valid itemvalid constant
logger log logger logger getlogg batch item oper batcheditemoper
flag copi method
copi
clone
clone remov exist clone remov exist
option code link checkaddnod code
code link checkremovenod code method
check access right
check access check access
option code link checkaddnod code
code link checkremovenod code method
check lock statu
check lock check lock
option code link checkaddnod code
code link checkremovenod code method
check check statu
check version check version
option code link checkaddnod code
code link checkremovenod code method
check constraint defin node type
check constraint check constraint
option code link checkremovenod code method
check target node referenc
check refer check refer
wrap item state manag
updat item state manag updatableitemstatemanag state mgr statemgr
lock manag check lock statu
lock manag lockmanag lock mgr lockmgr
current session check access right lock statu
session impl sessionimpl session
creat code batcheditemoper code instanc
param statemgr item state manag
param ntreg node type registri
param lockmgr lock manag
param session current session
param hiermgr hierarchi manag
param nsresolv namespac resolv
batch item oper batcheditemoper updat item state manag updatableitemstatemanag state mgr statemgr
node type registri nodetyperegistri reg ntreg
lock manag lockmanag lock mgr lockmgr
session impl sessionimpl session
hierarchi manag hierarchymanag hier mgr hiermgr
namespac resolv namespaceresolv resolv nsresolv
reg ntreg hier mgr hiermgr resolv nsresolv
state mgr statemgr state mgr statemgr
lock mgr lockmgr lock mgr lockmgr
session session
control batch oper
start edit oper wrap state manag
end oper link updat link cancel
invok
throw illegalstateexcept state manang edit mode
edit illeg state except illegalstateexcept
state mgr statemgr edit
store item state
param state item state store
throw illegalstateexcept manag edit mode
store item state itemst state illeg state except illegalstateexcept
state mgr statemgr store state
destroi item state
param state item state destroi
throw illegalstateexcept manag edit mode
destroi item state itemst state illeg state except illegalstateexcept
state mgr statemgr destroi state
end updat oper save made
invok link edit oper fail
item save
throw repositoryexcept updat oper fail
throw illegalstateexcept state manang edit mode
updat repositori except repositoryexcept illeg state except illegalstateexcept
state mgr statemgr updat
item state except itemstateexcept is
string msg updat oper fail
log debug msg is
repositori except repositoryexcept msg is
cancel updat oper undo made
invok link edit
throw illegalstateexcept state manang edit mode
cancel illeg state except illegalstateexcept
state mgr statemgr cancel
high level item oper
copi tree code srcpath code locat
code destpath code
precondit state manag edit mode
param srcpath
param destpath
param flag
code copi code
code clone code
code clone remov exist code
throw constraintviolationexcept
throw accessdeniedexcept
throw versionexcept
throw pathnotfoundexcept
throw itemexistsexcept
throw lockexcept
throw repositoryexcept
copi path src path srcpath path dest path destpath flag
constraint violat except constraintviolationexcept access deni except accessdeniedexcept
version except versionexcept path found except pathnotfoundexcept item exist except itemexistsexcept
lock except lockexcept repositori except repositoryexcept
copi src path srcpath state mgr statemgr hier mgr hiermgr session access manag getaccessmanag dest path destpath flag
copi tree code srcpath code retriev
code srcstatemgr code locat code destpath code
precondit state manag edit mode
param srcpath
param srcstatemgr
param srchiermgr
param srcaccessmgr
param destpath
param flag
code copi code
code clone code
code clone remov exist code
throw constraintviolationexcept
throw accessdeniedexcept
throw versionexcept
throw pathnotfoundexcept
throw itemexistsexcept
throw lockexcept
throw repositoryexcept
throw illegalstateexcept state manang edit mode
copi path src path srcpath
item state manag itemstatemanag src state mgr srcstatemgr
hierarchi manag hierarchymanag src hier mgr srchiermgr
access manag accessmanag src access mgr srcaccessmgr
path dest path destpath
flag
constraint violat except constraintviolationexcept access deni except accessdeniedexcept
version except versionexcept path found except pathnotfoundexcept item exist except itemexistsexcept
lock except lockexcept repositori except repositoryexcept illeg state except illegalstateexcept
check precondit
state mgr statemgr edit mode ineditmod
illeg state except illegalstateexcept edit mode
check path retriev state
node state nodest src state srcstate node state getnodest src state mgr srcstatemgr src hier mgr srchiermgr src path srcpath
path path element pathel dest destnam dest path destpath element getnameel
path dest parent path destparentpath dest path destpath ancestor getancestor
node state nodest dest parent state destparentst node state getnodest dest parent path destparentpath
ind dest destnam index getindex
ind
subscript element
string msg invalid destin path subscript element allow
log debug msg
repositori except repositoryexcept msg
check access right lock statu node type constraint
check add node checkaddnod dest parent state destparentst dest destnam getnam
src state srcstate node type getnodetypenam check access check access check lock check lock
check version check version check constraint check constraint
check read access sourc node sourc access manag
src access mgr srcaccessmgr grant isgrant src state srcstate getid access manag accessmanag read
path found except pathnotfoundexcept safe jcr path safegetjcrpath src path srcpath
item found except itemnotfoundexcept inf
string msg intern error fail check access right
safe jcr path safegetjcrpath src path srcpath
log debug msg
repositori except repositoryexcept msg inf
copi oper modifi store affect state
refer chang tracker referencechangetrack ref tracker reftrack refer chang tracker referencechangetrack
creat deep copi sourc node state
node state nodest state newstat copi node state copynodest src state srcstate src state mgr srcstatemgr src access mgr srcaccessmgr
dest parent state destparentst uuid getuuid flag ref tracker reftrack
add parent
dest parent state destparentst add child node entri addchildnodeentri dest destnam getnam state newstat uuid getuuid
chang definit node
node def nodedef node def newnodedef
find applic node definit findapplicablenodedefinit dest destnam getnam
src state srcstate node type getnodetypenam dest parent state destparentst
state newstat set definit setdefinitionid node def newnodedef getid
adjust refer refer uuid' map
newli gener uuid' copi clone
iter iter ref tracker reftrack process refer getprocessedrefer
iter hasnext
properti state propertyst prop properti state propertyst iter
paranoid
prop type gettyp properti type propertytyp refer
modifi
intern internalvalu valu prop valu getvalu
intern internalvalu val newval intern internalvalu valu length
valu length
intern internalvalu val valu
string origin uuid val intern internalvalu string tostr
string adjust ref tracker reftrack map uuid getmappeduuid origin
adjust
val newval intern internalvalu creat uuid string fromstr adjust
modifi
refer adjust copi
val newval val
modifi
prop set valu setvalu val newval
state mgr statemgr store prop
ref tracker reftrack clear
store state
state mgr statemgr store state newstat
state mgr statemgr store dest parent state destparentst
move tree code srcpath code locat
code destpath code
precondit state manag edit mode
param srcpath
param destpath
throw constraintviolationexcept
throw versionexcept
throw accessdeniedexcept
throw pathnotfoundexcept
throw itemexistsexcept
throw lockexcept
throw repositoryexcept
throw illegalstateexcept state manang edit mode
move path src path srcpath path dest path destpath
constraint violat except constraintviolationexcept version except versionexcept
access deni except accessdeniedexcept path found except pathnotfoundexcept item exist except itemexistsexcept
lock except lockexcept repositori except repositoryexcept illeg state except illegalstateexcept
check precondit
state mgr statemgr edit mode ineditmod
illeg state except illegalstateexcept edit mode
check path retriev state
src path srcpath ancestor isancestorof dest path destpath
string msg safe jcr path safegetjcrpath dest path destpath
invalid destin path descend sourc path
log debug msg
repositori except repositoryexcept msg
malform path except malformedpathexcept mpe
string msg invalid path safe jcr path safegetjcrpath dest path destpath
log debug msg
repositori except repositoryexcept msg mpe
path path element pathel src srcname src path srcpath element getnameel
path src parent path srcparentpath src path srcpath ancestor getancestor
node state nodest target node state getnodest src path srcpath
node state nodest src parent srcparent node state getnodest src parent path srcparentpath
path path element pathel dest destnam dest path destpath element getnameel
path dest parent path destparentpath dest path destpath ancestor getancestor
node state nodest dest parent destpar node state getnodest dest parent path destparentpath
ind dest destnam index getindex
ind
subscript element
string msg safe jcr path safegetjcrpath dest path destpath
invalid destin path subscript element allow
log debug msg
repositori except repositoryexcept msg
check target state remov ad parent
check remov node checkremovenod target node nodeid src parent srcparent getid
check access check access check lock check lock check version check version check constraint check constraint
check add node checkaddnod dest parent destpar dest destnam getnam
target node type getnodetypenam check access check access check lock check lock
check version check version check constraint check constraint
move oper modifi store affect state
renam renameonli src parent srcparent uuid getuuid equal dest parent destpar uuid getuuid
src index srcnameindex src srcname index getindex
src index srcnameindex
src index srcnameindex
remov parent
renam renameonli
dest parent destpar renam child node entri renamechildnodeentri src srcname getnam src index srcnameindex
dest destnam getnam
target remov parent uuid removeparentuuid src parent srcparent uuid getuuid
target add parent uuid addparentuuid dest parent destpar uuid getuuid
dest parent destpar add child node entri addchildnodeentri dest destnam getnam target uuid getuuid
src parent srcparent remov child node entri removechildnodeentri src srcname getnam src index srcnameindex
chang definit target node
node def nodedef target def newtargetdef
find applic node definit findapplicablenodedefinit dest destnam getnam
target node type getnodetypenam dest parent destpar
target set definit setdefinitionid target def newtargetdef getid
store state
state mgr statemgr store target
renam renameonli
state mgr statemgr store src parent srcparent
state mgr statemgr store dest parent destpar
state mgr statemgr store src parent srcparent
remov node recurs remov properti
child node
precondit state manag edit mode
param nodepath
throw constraintviolationexcept
throw accessdeniedexcept
throw versionexcept
throw lockexcept
throw itemnotfoundexcept
throw referentialintegrityexcept
throw repositoryexcept
throw illegalstateexcept
remov node removenod path node path nodepath
constraint violat except constraintviolationexcept access deni except accessdeniedexcept
version except versionexcept lock except lockexcept item found except itemnotfoundexcept
referenti integr except referentialintegrityexcept repositori except repositoryexcept
illeg state except illegalstateexcept
check precondit
state mgr statemgr edit mode ineditmod
illeg state except illegalstateexcept edit mode
retriev affect state
node state nodest target node state getnodest node path nodepath
node nodeid parent parentid node nodeid target parent uuid getparentuuid
node state nodest parent node state getnodest parent parentid
check target state remov parent
check remov node checkremovenod target parent parentid
check access check access check lock check lock check version check version
check constraint check constraint check refer check refer
remov oper modifi store affect state
unlink node state parent
unlink node state unlinknodest target target parent uuid getparentuuid
remov child node entri
temp arrai avoid concurrentmodificationexcept
arrai list arraylist tmp
arrai list arraylist parent child node entri getchildnodeentri target uuid getuuid
remov tail avoid problem sibl
tmp size
node state nodest child node entri childnodeentri entri node state nodest child node entri childnodeentri tmp
parent remov child node entri removechildnodeentri entri getnam entri index getindex
store parent
state mgr statemgr store parent
misc high level helper method
check ad child node call code nodenam code node type
code nodetypenam code parent node allow
current context
param parentst
param nodenam
param nodetypenam
param option bit wise or' flag check
perform combin constant
code link check access code make
current session grant read write access
parent node
code link check lock code make
foreign lock parent node
code link check version code make
parent node check
code link check constraint code
make node type constraint violat
code link check refer code
throw constraintviolationexcept
throw accessdeniedexcept
throw versionexcept
throw lockexcept
throw itemnotfoundexcept
throw itemexistsexcept
throw repositoryexcept
check add node checkaddnod node state nodest parent state parentst qname node nodenam
qname node type nodetypenam option
constraint violat except constraintviolationexcept access deni except accessdeniedexcept
version except versionexcept lock except lockexcept item found except itemnotfoundexcept
item exist except itemexistsexcept repositori except repositoryexcept
path parent path parentpath hier mgr hiermgr path getpath parent state parentst getid
lock statu
option check lock check lock check lock check lock
make foreign lock parent node
verifi unlock verifyunlock parent path parentpath
version statu
option check version check version check version check version
make parent node check
verifi check verifycheckedout parent path parentpath
access right
option check access check access check access check access
access manag accessmanag access mgr accessmgr session access manag getaccessmanag
make current session grant read access parent node
access mgr accessmgr grant isgrant parent state parentst getid access manag accessmanag read
item found except itemnotfoundexcept safe jcr path safegetjcrpath parent state parentst getid
make current session grant write access parent node
access mgr accessmgr grant isgrant parent state parentst getid access manag accessmanag write
access deni except accessdeniedexcept safe jcr path safegetjcrpath parent state parentst getid
allow add child node
node type constraint
option check constraint check constraint check constraint check constraint
node def nodedef parent def parentdef reg ntreg node def getnodedef parent state parentst definit getdefinitionid
make parent node protect
parent def parentdef protect isprotect
constraint violat except constraintviolationexcept safe jcr path safegetjcrpath parent state parentst getid
add child node protect parent node
make applic definit child node
effect node type effectivenodetyp ent parent entpar effect node type geteffectivenodetyp parent state parentst
ent parent entpar check add node constraint checkaddnodeconstraint node nodenam node type nodetypenam
node def nodedef node def newnodedef
find applic node definit findapplicablenodedefinit node nodenam node type nodetypenam
parent state parentst
check collis
parent state parentst properti entri haspropertyentri node nodenam
properti
item exist except itemexistsexcept add child node
node nodenam local getlocalnam
safe jcr path safegetjcrpath parent state parentst getid
collid name exist properti
parent state parentst child node entri haschildnodeentri node nodenam
node
definit exist conflict node
node state nodest child node entri childnodeentri entri parent state parentst child node entri getchildnodeentri node nodenam
node state nodest conflict state conflictingst
node nodeid conflict conflictingid node nodeid entri uuid getuuid
conflict state conflictingst node state nodest state mgr statemgr item state getitemst conflict conflictingid
item state except itemstateexcept is
string msg intern error fail retriev state
safe jcr path safegetjcrpath conflict conflictingid
log debug msg
repositori except repositoryexcept msg is
node def nodedef conflict target def conflictingtargetdef
reg ntreg node def getnodedef conflict state conflictingst definit getdefinitionid
check sibl set target exist node
conflict target def conflictingtargetdef sibl allowssamenames
node def newnodedef sibl allowssamenames
item exist except itemexistsexcept add child node
node nodenam local getlocalnam
safe jcr path safegetjcrpath parent state parentst getid
collid name exist node
check remov target node unlink
parent allow current context
param targetst
param option bit wise or' flag check
perform combin constant
code link check access code make
current session grant read access parent
remov privileg target node
code link check lock code make
foreign lock parent node
code link check version code make
parent node check
code link check constraint code
make node type constraint violat
code link check refer code
make refer exist target node
throw constraintviolationexcept
throw accessdeniedexcept
throw versionexcept
throw lockexcept
throw itemnotfoundexcept
throw referentialintegrityexcept
throw repositoryexcept
check remov node checkremovenod node state nodest target state targetst option
constraint violat except constraintviolationexcept access deni except accessdeniedexcept
version except versionexcept lock except lockexcept item found except itemnotfoundexcept
referenti integr except referentialintegrityexcept repositori except repositoryexcept
list parent uui parentuuid target state targetst parent uui getparentuuid
iter iter parent uui parentuuid iter
iter hasnext
node nodeid parent parentid node nodeid string iter
check remov node checkremovenod target state targetst parent parentid option
check remov target node specif parent
allow current context
param targetst
param parentid
param option bit wise or' flag check
perform combin constant
code link check access code make
current session grant read access parent
remov privileg target node
code link check lock code make
foreign lock parent node
code link check version code make
parent node check
code link check constraint code
make node type constraint violat
code link check refer code
make refer exist target node
throw constraintviolationexcept
throw accessdeniedexcept
throw versionexcept
throw lockexcept
throw itemnotfoundexcept
throw referentialintegrityexcept
throw repositoryexcept
check remov node checkremovenod node state nodest target state targetst node nodeid parent parentid
option
constraint violat except constraintviolationexcept access deni except accessdeniedexcept
version except versionexcept lock except lockexcept item found except itemnotfoundexcept
referenti integr except referentialintegrityexcept repositori except repositoryexcept
target state targetst parent uuid getparentuuid
root orphan node
constraint violat except constraintviolationexcept remov root node
node nodeid target targetid node nodeid target state targetst getid
node state nodest parent state parentst node state getnodest parent parentid
path parent path parentpath hier mgr hiermgr path getpath parent parentid
lock statu
option check lock check lock check lock check lock
make foreign lock parent node
verifi unlock verifyunlock parent path parentpath
version statu
option check version check version check version check version
make parent node check
verifi check verifycheckedout parent path parentpath
access right
option check access check access check access check access
access manag accessmanag access mgr accessmgr session access manag getaccessmanag
make current session grant read access parent node
access mgr accessmgr grant isgrant target targetid access manag accessmanag read
path found except pathnotfoundexcept safe jcr path safegetjcrpath target targetid
make current session allow remov target node
access mgr accessmgr grant isgrant target targetid access manag accessmanag remov
access deni except accessdeniedexcept safe jcr path safegetjcrpath target targetid
allow remov node
item found except itemnotfoundexcept inf
string msg intern error fail check access right
safe jcr path safegetjcrpath target targetid
log debug msg
repositori except repositoryexcept msg inf
node type constraint
option check constraint check constraint check constraint check constraint
node def nodedef parent def parentdef reg ntreg node def getnodedef parent state parentst definit getdefinitionid
parent def parentdef protect isprotect
constraint violat except constraintviolationexcept safe jcr path safegetjcrpath parent parentid
remov child node protect parent node
node def nodedef target def targetdef reg ntreg node def getnodedef target state targetst definit getdefinitionid
target def targetdef mandatori ismandatori
constraint violat except constraintviolationexcept safe jcr path safegetjcrpath target targetid
remov mandatori node
target def targetdef protect isprotect
constraint violat except constraintviolationexcept safe jcr path safegetjcrpath target targetid
remov protect node
referenti integr
option check refer check refer check refer check refer
effect node type effectivenodetyp ent effect node type geteffectivenodetyp target state targetst
ent includ node type includesnodetyp mix referenc mix referenc
node refer nodereferencesid ref refsid node refer nodereferencesid target state targetst uuid getuuid
state mgr statemgr node refer hasnoderefer ref refsid
node refer noderefer ref state mgr statemgr node refer getnoderefer ref refsid
ref refer hasrefer
referenti integr except referentialintegrityexcept safe jcr path safegetjcrpath target targetid
remov node refer
item state except itemstateexcept is
string msg intern error fail check refer
safe jcr path safegetjcrpath target targetid
log error msg is
repositori except repositoryexcept msg is
verifi node code nodepath code writabl
condit hold true
node exist
current session grant read write access
node lock session
node check
node protect
param nodepath path node check
throw pathnotfoundexcept node exist
code nodepath code current
session grant read access
path
throw accessdeniedexcept write access
path allow
throw constraintviolationexcept node code nodepath code
protect
throw versionexcept node code nodepath code
check
throw lockexcept node code nodepath code
lock session
throw repositoryexcept error occur
verifi write verifycanwrit path node path nodepath
path found except pathnotfoundexcept access deni except accessdeniedexcept
constraint violat except constraintviolationexcept version except versionexcept lock except lockexcept
repositori except repositoryexcept
node state nodest node node state getnodest node path nodepath
access right
access manag accessmanag access mgr accessmgr session access manag getaccessmanag
make current session grant read access node
access mgr accessmgr grant isgrant node getid access manag accessmanag read
path found except pathnotfoundexcept safe jcr path safegetjcrpath node getid
make current session grant write access node
access mgr accessmgr grant isgrant node getid access manag accessmanag write
access deni except accessdeniedexcept safe jcr path safegetjcrpath node getid
allow modifi node
lock statu
verifi unlock verifyunlock node path nodepath
node type constraint
verifi protect verifynotprotect node path nodepath
version statu
verifi check verifycheckedout node path nodepath
verifi node code nodepath code read
condit hold true
node exist
current session grant read access
param nodepath path node check
throw pathnotfoundexcept node exist
code nodepath code current
session grant read access
path
throw repositoryexcept error occur
verifi read verifycanread path node path nodepath
path found except pathnotfoundexcept repositori except repositoryexcept
node state nodest node node state getnodest node path nodepath
access right
access manag accessmanag access mgr accessmgr session access manag getaccessmanag
make current session grant read access node
access mgr accessmgr grant isgrant node getid access manag accessmanag read
path found except pathnotfoundexcept safe jcr path safegetjcrpath node getid
helper method find applic definit child node
node type parent node' node type
mixin type
param
param nodetypenam
param parentst
return code nodedef code
throw constraintviolationexcept applic child node definit
found
throw repositoryexcept error occur
node def nodedef find applic node definit findapplicablenodedefinit qname
qname node type nodetypenam
node state nodest parent state parentst
repositori except repositoryexcept constraint violat except constraintviolationexcept
effect node type effectivenodetyp ent parent entpar effect node type geteffectivenodetyp parent state parentst
ent parent entpar applic child node def getapplicablechildnodedef node type nodetypenam
helper method find applic definit properti
type multivalu characterist parent node'
node type mixin type applic definit
rule appli
name definit prefer residu definit
definit specif requir type prefer definit
requir type undefin
param
param type
param multivalu
param parentst
return code propdef code
throw constraintviolationexcept applic properti definit
found
throw repositoryexcept error occur
prop def propdef find applic properti definit findapplicablepropertydefinit qname
type
multi valu multivalu
node state nodest parent state parentst
repositori except repositoryexcept constraint violat except constraintviolationexcept
effect node type effectivenodetyp ent parent entpar effect node type geteffectivenodetyp parent state parentst
ent parent entpar applic properti def getapplicablepropertydef type multi valu multivalu
helper method find applic definit properti
type parent node' node type mixin type
code link findapplicablepropertydefinit qname int boolean nodest code
method multivalu flag account
select algorithm applic definit
rule appli
name definit prefer residu definit
definit specif requir type prefer definit
requir type undefin
singl definit prefer multipl definit
param
param type
param parentst
return code propdef code
throw constraintviolationexcept applic properti definit
found
throw repositoryexcept error occur
prop def propdef find applic properti definit findapplicablepropertydefinit qname
type
node state nodest parent state parentst
repositori except repositoryexcept constraint violat except constraintviolationexcept
effect node type effectivenodetyp ent parent entpar effect node type geteffectivenodetyp parent state parentst
ent parent entpar applic properti def getapplicablepropertydef type
low level item oper
creat node
note access right enforc
precondit state manag edit mode
param parent
param nodenam
param nodetypenam
param mixinnam
param uuid
return
throw itemexistsexcept
throw constraintviolationexcept
throw repositoryexcept
throw illegalstateexcept state manang edit mode
node state nodest creat node state createnodest node state nodest parent
qname node nodenam
qname node type nodetypenam
qname mixin name mixinnam
string uuid
item exist except itemexistsexcept constraint violat except constraintviolationexcept
repositori except repositoryexcept illeg state except illegalstateexcept
check precondit
state mgr statemgr edit mode ineditmod
illeg state except illegalstateexcept edit mode
node def nodedef def find applic node definit findapplicablenodedefinit node nodenam node type nodetypenam parent
creat node state createnodest parent node nodenam node type nodetypenam mixin name mixinnam uuid def
creat node base definit
note access right enforc
precondit state manag edit mode
param parent
param nodenam
param nodetypenam
param mixinnam
param uuid
param def
return
throw itemexistsexcept
throw constraintviolationexcept
throw repositoryexcept
throw illegalstateexcept
node state nodest creat node state createnodest node state nodest parent
qname node nodenam
qname node type nodetypenam
qname mixin name mixinnam
string uuid
node def nodedef def
item exist except itemexistsexcept constraint violat except constraintviolationexcept
repositori except repositoryexcept illeg state except illegalstateexcept
check collis exist properti
parent properti entri haspropertyentri node nodenam
string msg properti node nodenam
log debug msg
repositori except repositoryexcept msg
check collis exist node
def sibl allowssamenames parent child node entri haschildnodeentri node nodenam
node nodeid node nodeid parent child node entri getchildnodeentri node nodenam uuid getuuid
item exist except itemexistsexcept safe jcr path safegetjcrpath
uuid
creat uuid
uuid uuid random uuid randomuuid string tostr uuid uuid randomuuid tostr creat version uuid
node type nodetypenam
primari node type
default primari type definit
node type nodetypenam def default primari type getdefaultprimarytyp
node type nodetypenam
string msg applic node type determin
node nodenam
log debug msg
constraint violat except constraintviolationexcept msg
node state nodest node state mgr statemgr creat createnew uuid node type nodetypenam parent uuid getuuid
mixin name mixinnam mixin name mixinnam length
node set mixin type name setmixintypenam hash set hashset arrai list aslist mixin name mixinnam
node set definit setdefinitionid def getid
add child node entri parent
parent add child node entri addchildnodeentri node nodenam node uuid getuuid
effect node type effectivenodetyp ent effect node type geteffectivenodetyp node
node mixin type name getmixintypenam empti isempti
creat jcr mixintyp properti
prop def propdef ent applic properti def getapplicablepropertydef jcr mixintyp jcr mixintyp
properti type propertytyp
creat properti state createpropertyst node getnam requir type getrequiredtyp
add 'auto create' properti defin node type
prop def propdef pda ent auto creat prop def getautocreatepropdef
pda length
prop def propdef pda
creat properti state createpropertyst node getnam requir type getrequiredtyp
recurs add 'auto create' child node defin node type
node def nodedef nda ent auto creat node def getautocreatenodedef
nda length
node def nodedef nda
creat node state createnodest node getnam default primari type getdefaultprimarytyp
store node
state mgr statemgr store node
store parent
state mgr statemgr store parent
node
creat properti
note access right enforc
precondit state manag edit mode
param parent
param propnam
param type
param numvalu
return
throw itemexistsexcept
throw constraintviolationexcept
throw repositoryexcept
throw illegalstateexcept state manang edit mode
properti state propertyst creat properti state createpropertyst node state nodest parent
qname prop propnam
type
num valu numvalu
item exist except itemexistsexcept constraint violat except constraintviolationexcept
repositori except repositoryexcept illeg state except illegalstateexcept
check precondit
state mgr statemgr edit mode ineditmod
illeg state except illegalstateexcept edit mode
find applic definit
prop def propdef def
multi singl valu properti
num valu numvalu
singl multi valu
singl valu
def find applic properti definit findapplicablepropertydefinit prop propnam
type parent
constraint violat except constraintviolationexcept cve
multi valu
def find applic properti definit findapplicablepropertydefinit prop propnam
type parent
multi valu
def find applic properti definit findapplicablepropertydefinit prop propnam
type parent
creat properti state createpropertyst parent prop propnam type def
creat properti base definit
note access right enforc
precondit state manag edit mode
param parent
param propnam
param type
param def
return
throw itemexistsexcept
throw repositoryexcept
properti state propertyst creat properti state createpropertyst node state nodest parent
qname prop propnam
type
prop def propdef def
item exist except itemexistsexcept repositori except repositoryexcept
check collis exist child node
parent child node entri haschildnodeentri prop propnam
string msg child node prop propnam
log debug msg
repositori except repositoryexcept msg
check collis exist properti
parent properti entri haspropertyentri prop propnam
properti propertyid properti propertyid parent uuid getuuid
parent properti entri getpropertyentri prop propnam getnam
item exist except itemexistsexcept safe jcr path safegetjcrpath
creat properti
properti state propertyst prop state mgr statemgr creat createnew prop propnam parent uuid getuuid
prop set definit setdefinitionid def getid
def requir type getrequiredtyp properti type propertytyp undefin
prop set type settyp def requir type getrequiredtyp
type properti type propertytyp undefin
prop set type settyp type
prop set type settyp properti type propertytyp string
prop set multi valu setmultivalu def multipl ismultipl
comput system gener valu
intern internalvalu gen valu genvalu
comput system gener properti valu computesystemgeneratedpropertyvalu parent def
gen valu genvalu
prop set valu setvalu gen valu genvalu
def default valu getdefaultvalu
prop set valu setvalu def default valu getdefaultvalu
add properti entri parent
parent add properti entri addpropertyentri prop propnam
store parent
state mgr statemgr store parent
prop
unlink node state parent recurs
remov includ properti child node
note access right enforc
param targetst
throw repositoryexcept error occur
remov node state removenodest node state nodest target state targetst
repositori except repositoryexcept
copi list avoid concurrentmodificationexcept
arrai list arraylist parent uui parentuuid arrai list arraylist target state targetst parent uui getparentuuid
iter iter parent uui parentuuid iter
iter hasnext
string parent uuid parentuuid string iter
node nodeid parent parentid node nodeid parent uuid parentuuid
unlink node state parent
unlink node state unlinknodest target state targetst parent uuid parentuuid
remov child node entri
node state nodest parent node state getnodest parent parentid
temp arrai avoid concurrentmodificationexcept
arrai list arraylist tmp
arrai list arraylist parent child node entri getchildnodeentri target state targetst uuid getuuid
remov tail avoid problem sibl
tmp size
node state nodest child node entri childnodeentri entri node state nodest child node entri childnodeentri tmp
parent remov child node entri removechildnodeentri entri getnam entri index getindex
store parent
state mgr statemgr store parent
retriev state node path
note access right enforc
param nodepath
return
throw pathnotfoundexcept
throw repositoryexcept
node state nodest node state getnodest path node path nodepath
path found except pathnotfoundexcept repositori except repositoryexcept
node state getnodest state mgr statemgr hier mgr hiermgr node path nodepath
retriev state node
note access right enforc
param
return
throw itemnotfoundexcept
throw repositoryexcept
node state nodest node state getnodest node nodeid
item found except itemnotfoundexcept repositori except repositoryexcept
node state nodest item state getitemst state mgr statemgr
retriev state item
note access right enforc
param
return
throw itemnotfoundexcept
throw repositoryexcept
item state itemst item state getitemst item itemid
item found except itemnotfoundexcept repositori except repositoryexcept
item state getitemst state mgr statemgr
protect method
verifi node code nodepath code check throw
code versionexcept code case
node consid check version
check version nearest version ancestor
check version version
ancestor
param nodepath
throw pathnotfoundexcept
throw versionexcept
throw repositoryexcept
verifi check verifycheckedout path node path nodepath
path found except pathnotfoundexcept version except versionexcept repositori except repositoryexcept
search nearest ancestor version start node nodepath
fixm reli exist jcr ischeckedout properti
verifi node isnodetyp mix version true
neg impact perform
node state nodest node state nodest node state getnodest node path nodepath
node state nodest properti entri haspropertyentri jcr ischeckedout jcr ischeckedout
node path nodepath denot root denotesroot
node path nodepath node path nodepath ancestor getancestor
node state nodest node state getnodest node path nodepath
properti propertyid prop propid
properti propertyid node state nodest uuid getuuid jcr ischeckedout jcr ischeckedout
properti state propertyst prop state propstat
prop state propstat properti state propertyst state mgr statemgr item state getitemst prop propid
item state except itemstateexcept is
string msg intern error fail retriev state
safe jcr path safegetjcrpath prop propid
log debug msg
repositori except repositoryexcept msg is
check checkedout boolean prop state propstat valu getvalu intern internalvalu boolean booleanvalu
check checkedout
version except versionexcept safe jcr path safegetjcrpath node path nodepath check
verifi node code nodepath code lock
current session
param nodepath path node check
throw pathnotfoundexcept
throw lockexcept write access path allow
throw repositoryexcept error occur
verifi unlock verifyunlock path node path nodepath
lock except lockexcept repositori except repositoryexcept
make foreign lock node nodepath
lock mgr lockmgr check lock checklock node path nodepath session
verifi node code nodepath code protect
param nodepath path node check
throw pathnotfoundexcept node exist code nodepath code
throw constraintviolationexcept write access
path allow
throw repositoryexcept error occur
verifi protect verifynotprotect path node path nodepath
path found except pathnotfoundexcept constraint violat except constraintviolationexcept
repositori except repositoryexcept
node state nodest node node state getnodest node path nodepath
node def nodedef parent def parentdef reg ntreg node def getnodedef node definit getdefinitionid
parent def parentdef protect isprotect
constraint violat except constraintviolationexcept safe jcr path safegetjcrpath node path nodepath
node protect
retriev state node code nodepath code
item state manag
note access right enforc
param srcstatemgr
param srchiermgr
param nodepath
return
throw pathnotfoundexcept
throw repositoryexcept
node state nodest node state getnodest item state manag itemstatemanag src state mgr srcstatemgr
hierarchi manag hierarchymanag src hier mgr srchiermgr
path node path nodepath
path found except pathnotfoundexcept repositori except repositoryexcept
item itemid src hier mgr srchiermgr resolv path resolvepath node path nodepath
denot node denotesnod
path found except pathnotfoundexcept safe jcr path safegetjcrpath node path nodepath
node state nodest item state getitemst src state mgr srcstatemgr
item found except itemnotfoundexcept inf
path found except pathnotfoundexcept safe jcr path safegetjcrpath node path nodepath
retriev state item
item state manag
note access right enforc
param srcstatemgr
param
return
throw itemnotfoundexcept
throw repositoryexcept
item state itemst item state getitemst item state manag itemstatemanag src state mgr srcstatemgr item itemid
item found except itemnotfoundexcept repositori except repositoryexcept
src state mgr srcstatemgr item state getitemst
item state except nosuchitemstateexcept nsise
item found except itemnotfoundexcept safe jcr path safegetjcrpath
item state except itemstateexcept is
string msg intern error fail retriev state
safe jcr path safegetjcrpath
log debug msg
repositori except repositoryexcept msg is
privat method
comput valu system protect properti
todo duplic code nodeimpl consolid deleg nodetypeinstancehandl
param parent
param def
return
intern internalvalu comput system gener properti valu computesystemgeneratedpropertyvalu node state nodest parent
prop def propdef def
intern internalvalu gen valu genvalu
todo callback mechan appli system gener valu
nodetypeinstancehandl interfac
comput system gener valu
qname declar declaringnt def declar node type getdeclaringnodetyp
qname def getnam
mix referenc mix referenc equal declar declaringnt
mix referenc node type
jcr uuid jcr uuid equal
jcr uuid properti
gen valu genvalu intern internalvalu intern internalvalu creat parent uuid getuuid
base base equal declar declaringnt
base node type
jcr primarytyp jcr primarytyp equal
jcr primarytyp properti
gen valu genvalu intern internalvalu intern internalvalu creat parent node type getnodetypenam
jcr mixintyp jcr mixintyp equal
jcr mixintyp properti
set mixin parent mixin type name getmixintypenam
arrai list arraylist valu arrai list arraylist mixin size
iter iter mixin iter
iter hasnext
valu add intern internalvalu creat qname iter
gen valu genvalu intern internalvalu valu arrai toarrai intern internalvalu valu size
hierarchynod hierarchynod equal declar declaringnt
hierarchynod node type
jcr creat jcr creat equal
jcr creat properti
gen valu genvalu intern internalvalu intern internalvalu creat calendar instanc getinst
resourc resourc equal declar declaringnt
resourc node type
jcr lastmodifi jcr lastmodifi equal
jcr lastmodifi properti
gen valu genvalu intern internalvalu intern internalvalu creat calendar instanc getinst
version version equal declar declaringnt
version node type
jcr creat jcr creat equal
jcr creat properti
gen valu genvalu intern internalvalu intern internalvalu creat calendar instanc getinst
gen valu genvalu
unlink node state parent remov
code parentuuid code list parent result
node state orphan recurs remov
includ properti child node
note child node entri refer code targetst code
automat remov code targetst code
parent denot code parentuuid code
param targetst
param parentuuid
throw repositoryexcept error occur
unlink node state unlinknodest node state nodest target state targetst string parent uuid parentuuid
repositori except repositoryexcept
check node state orphan unlink parent
arrai list arraylist parent uui parentuuid arrai list arraylist target state targetst parent uui getparentuuid
parent uui parentuuid remov parent uuid parentuuid
orphan parent uui parentuuid empti isempti
orphan
remov child node
temp arrai avoid concurrentmodificationexcept
arrai list arraylist tmp arrai list arraylist target state targetst child node entri getchildnodeentri
remov tail avoid problem sibl
tmp size
node state nodest child node entri childnodeentri entri node state nodest child node entri childnodeentri tmp
node nodeid node nodeid node nodeid entri uuid getuuid
node state nodest node state nodest node state nodest state mgr statemgr item state getitemst node nodeid
check child node remov
access right lock version statu
check remov node checkremovenod node state nodest node nodeid target state targetst getid
check access check access check lock check lock check version check version
unlink child node recurs
unlink node state unlinknodest node state nodest target state targetst uuid getuuid
item state except itemstateexcept is
string msg intern error fail retriev state
node nodeid
log debug msg
repositori except repositoryexcept msg is
remov child node entri
target state targetst remov child node entri removechildnodeentri entri getnam entri index getindex
remov properti
temp arrai avoid concurrentmodificationexcept
tmp arrai list arraylist target state targetst properti entri getpropertyentri
tmp size
node state nodest properti entri propertyentri entri node state nodest properti entri propertyentri tmp
properti propertyid prop propid
properti propertyid target state targetst uuid getuuid entri getnam
properti state propertyst prop state propstat
properti state propertyst state mgr statemgr item state getitemst prop propid
remov properti entri
target state targetst remov properti entri removepropertyentri prop propid getnam
destroi properti state
state mgr statemgr destroi prop state propstat
item state except itemstateexcept is
string msg intern error fail retriev state
prop propid
log debug msg
repositori except repositoryexcept msg is
unlink target state parent state
remov uuid parent state target state' parent list
target state targetst remov parent uuid removeparentuuid parent uuid parentuuid
orphan
destroi target state pass overlai state target state
modifi unlink
state mgr statemgr destroi target state targetst overlai state getoverlayedst
store target state
state mgr statemgr store target state targetst
recurs copi node state includ properti
child node
param srcstate
param srcstatemgr
param srcaccessmgr
param destparentuuid
param flag
code copi code
code clone code
code clone remov exist code
param reftrack track uuid map process refer properti
return deep copi node state children
throw repositoryexcept error occur
node state nodest copi node state copynodest node state nodest src state srcstate
item state manag itemstatemanag src state mgr srcstatemgr
access manag accessmanag src access mgr srcaccessmgr
string dest parent uuid destparentuuid
flag
refer chang tracker referencechangetrack ref tracker reftrack
repositori except repositoryexcept
node state nodest state newstat
string uuid
node nodeid
effect node type effectivenodetyp ent effect node type geteffectivenodetyp src state srcstate
referenc ent includ node type includesnodetyp mix referenc mix referenc
flag
copi
creat uuid
uuid uuid random uuid randomuuid string tostr uuid uuid randomuuid tostr creat version uuid
referenc
rememb uuid map
ref tracker reftrack map uuid mappeduuid src state srcstate uuid getuuid uuid
clone
referenc
referenc node creat uuid
uuid uuid random uuid randomuuid string tostr uuid uuid randomuuid tostr creat version uuid
uuid sourc node
uuid src state srcstate uuid getuuid
node nodeid uuid
state mgr statemgr item state hasitemst
node uuid exist
item exist except itemexistsexcept safe jcr path safegetjcrpath
clone remov exist clone remov exist
referenc
referenc node creat uuid
uuid uuid random uuid randomuuid string tostr uuid uuid randomuuid tostr creat version uuid
uuid sourc node
uuid src state srcstate uuid getuuid
node nodeid uuid
state mgr statemgr item state hasitemst
node state nodest exist state existingst node state nodest state mgr statemgr item state getitemst
make exist node parent
ancestor thereof
node nodeid parent newparentid node nodeid dest parent uuid destparentuuid
path hier mgr hiermgr path getpath parent newparentid
path hier mgr hiermgr path getpath
equal ancestor isancestorof
string msg remov ancestor node
log debug msg
repositori except repositoryexcept msg
malform path except malformedpathexcept mpe
string msg intern error fail determin degre relationship
log error msg mpe
repositori except repositoryexcept msg mpe
check exist remov
check remov node checkremovenod exist state existingst check access check access check lock check lock
check version check version check constraint check constraint
remov exist
remov node state removenodest exist state existingst
illeg argument except illegalargumentexcept unknown flag
state newstat state mgr statemgr creat createnew uuid src state srcstate node type getnodetypenam dest parent uuid destparentuuid
copi node state
state newstat set mixin type name setmixintypenam src state srcstate mixin type name getmixintypenam
state newstat set definit setdefinitionid src state srcstate definit getdefinitionid
copi child node
iter iter src state srcstate child node entri getchildnodeentri iter
iter hasnext
node state nodest child node entri childnodeentri entri node state nodest child node entri childnodeentri iter
node nodeid node nodeid node nodeid entri uuid getuuid
src access mgr srcaccessmgr grant isgrant node nodeid access manag accessmanag read
node state nodest src child state srcchildstat node state nodest src state mgr srcstatemgr item state getitemst node nodeid
special handl requir child node special semant
defin version
todo fixm deleg 'node type instanc handler'
recurs copi child node
node state nodest child state newchildst copi node state copynodest src child state srcchildstat
src state mgr srcstatemgr src access mgr srcaccessmgr uuid flag ref tracker reftrack
store child node
state mgr statemgr store child state newchildst
add child node entri node
state newstat add child node entri addchildnodeentri entri getnam child state newchildst uuid getuuid
copi properti
iter src state srcstate properti entri getpropertyentri iter
iter hasnext
node state nodest properti entri propertyentri entri node state nodest properti entri propertyentri iter
properti propertyid prop propid properti propertyid src state srcstate uuid getuuid entri getnam
src access mgr srcaccessmgr grant isgrant prop propid access manag accessmanag read
properti state propertyst src child state srcchildstat
properti state propertyst src state mgr srcstatemgr item state getitemst prop propid
special handl requir properti special semant
defin mix referenc mix version
mix lockabl
todo fixm deleg 'node type instanc handler'
prop def propdefid def defid src child state srcchildstat definit getdefinitionid
prop def propdef def reg ntreg prop def getpropdef def defid
def declar node type getdeclaringnodetyp equal mix lockabl mix lockabl
skip properti defin mix lockabl
properti state propertyst child state newchildst
copi properti state copypropertyst src child state srcchildstat uuid entri getnam
child state newchildst type gettyp properti type propertytyp refer
ref tracker reftrack process refer processedrefer child state newchildst
store properti
state mgr statemgr store child state newchildst
add properti entri node
state newstat add properti entri addpropertyentri entri getnam
state newstat
item state except itemstateexcept is
string msg intern error fail copi state src state srcstate getid
log debug msg
repositori except repositoryexcept msg is
copi properti state
param srcstate
param parentuuid
param propnam
return
throw repositoryexcept
properti state propertyst copi properti state copypropertyst properti state propertyst src state srcstate
string parent uuid parentuuid
qname prop propnam
repositori except repositoryexcept
prop def propdefid def defid src state srcstate definit getdefinitionid
prop def propdef def reg ntreg prop def getpropdef def defid
properti state propertyst state newstat state mgr statemgr creat createnew prop propnam parent uuid parentuuid
state newstat set definit setdefinitionid def defid
state newstat set type settyp src state srcstate type gettyp
state newstat set multi valu setmultivalu src state srcstate multi valu ismultivalu
intern internalvalu valu src state srcstate valu getvalu
valu
special handl requir properti special semant
defin mix referenc mix version
mix lockabl
todo fixm deleg 'node type instanc handler'
def declar node type getdeclaringnodetyp equal mix referenc mix referenc
prop propnam equal jcr uuid jcr uuid
set correct jcr uuid properti
state newstat set valu setvalu intern internalvalu intern internalvalu creat parent uuid parentuuid
intern internalvalu valu newvalu intern internalvalu valu length
valu length
valu newvalu valu creat copi createcopi
state newstat set valu setvalu valu newvalu
state newstat
