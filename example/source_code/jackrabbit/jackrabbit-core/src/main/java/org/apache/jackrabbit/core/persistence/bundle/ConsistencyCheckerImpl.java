org apach jackrabbit core persist bundl
java util arrai list arraylist
java util collect
java util hash set hashset
java util list
java util random
java util set
javax jcr repositori except repositoryexcept
org apach jackrabbit core node nodeid
org apach jackrabbit core persist check consist checker consistencycheck
org apach jackrabbit core persist check consist report consistencyreport
org apach jackrabbit core persist check consist report impl consistencyreportimpl
org apach jackrabbit core persist check report item reportitem
org apach jackrabbit core persist check report item impl reportitemimpl
org apach jackrabbit core persist util node prop bundl nodepropbundl
org apach jackrabbit core state item state except itemstateexcept
org apach jackrabbit spi factori namefactori
org apach jackrabbit spi common constant nameconst
org apach jackrabbit spi common factori impl namefactoryimpl
org slf4j logger
org slf4j logger factori loggerfactori
consist checker impl consistencycheckerimpl consist checker consistencycheck
default logger
logger log logger factori loggerfactori logger getlogg consist checker impl consistencycheckerimpl
abstract bundl persist manag abstractbundlepersistencemanag
factori namefactori factori impl namefactoryimpl instanc getinst
consist checker impl consistencycheckerimpl abstract bundl persist manag abstractbundlepersistencemanag
consist report consistencyreport check string uuid recurs fix string lost found lostnfoundid
repositori except repositoryexcept
set report item reportitem report hash set hashset report item reportitem
tstart system current time milli currenttimemilli
total intern check consist internalcheckconsist uuid recurs fix report lost found lostnfoundid
elaps system current time milli currenttimemilli tstart
consist report impl consistencyreportimpl total elaps report
intern check consist internalcheckconsist string uuid recurs fix set report item reportitem report
string lost found lostnfoundid repositori except repositoryexcept
count
total
collect node prop bundl nodepropbundl modif arrai list arraylist node prop bundl nodepropbundl
set node nodeid orphan hash set hashset node nodeid
node nodeid lost found lostnfound
fix lost found lostnfoundid
lost found node
node nodeid tmpid node nodeid lost found lostnfoundid
node prop bundl nodepropbundl bundl lfbundl load bundl loadbundl tmpid
bundl lfbundl
log error 'lost found' node exist
constant nameconst unstructur unstructur equal bundl lfbundl node type getnodetypenam
log error 'lost found' node type unstruct
lost found lostnfound bundl lfbundl getid
except
log error find 'lost found' folder
uuid
list node nodeid id allid node id getallnodeid
total id allid size
node nodeid id allid
pars check bundl
node prop bundl nodepropbundl bundl load bundl loadbundl
bundl
log error bundl found
check bundl consist checkbundleconsist bundl fix modif lost found lostnfound orphan report
count
count
log info check count total total bundl
item state except itemstateexcept
problem log loadbundl call
logdetailederror true
item state except itemstateexcept
repositori except repositoryexcept nodeid
total count
check uuid handl recurs flag
convert uuid arrai modifi list
uuid
load node bundl
check bundl store bundl modifi collect
recurs add child uuid list uuid
list node nodeid list idlist arrai list arraylist node nodeid uuid length
convert uuid string arrai list uuid object
uuid length
list idlist add node nodeid uuid
illeg argument except illegalargumentexcept
log error invalid consist check skip uuid
iter uuid includ newli ad insid loop
list idlist size
node nodeid list idlist
load node databas
node prop bundl nodepropbundl bundl load bundl loadbundl
bundl
log error bundl found
check bundl consist checkbundleconsist bundl fix modif lost found lostnfound orphan report
recurs
node prop bundl nodepropbundl child node entri childnodeentri entri bundl child node entri getchildnodeentri
list idlist add entri getid
count
count
log info check count list idlist size bundl
item state except itemstateexcept
problem log loadbundl call logdetailederror true
total list idlist size
repair collect broken bundl
fix modif empti isempti
log info fix modif size inconsist bundl
node prop bundl nodepropbundl bundl modif
log info fix bundl bundl getid
bundl mark markold bundl markold updat insert
store bundl storebundl bundl
evict bundl evictbundl bundl getid
item state except itemstateexcept
log error error store fix bundl
fix lost found lostnfoundid orphan empti isempti
thing add lost found
node prop bundl nodepropbundl bundl lfbundl load bundl loadbundl lost found lostnfound
bundl lfbundl
log error 'lost found' node exist
constant nameconst unstructur unstructur equal bundl lfbundl node type getnodetypenam
log error 'lost found' node type unstruct
bundl lfbundl mark markold
node nodeid orphan orphan
string node nodenam orphan system current time milli currenttimemilli
bundl lfbundl add child node entri addchildnodeentri creat node nodenam orphan
store bundl storebundl bundl lfbundl
evict bundl evictbundl bundl lfbundl getid
except
log error orphan adopt
log info check count total bundl
total
check singl bundl inconsist inexist child node
inexist parent
param node bundl check
param bundl bundl check
param fix code true code repair thing repair
param modif code fix true code collect repair
linkplain nodepropbundl bundl
check bundl consist checkbundleconsist node nodeid node prop bundl nodepropbundl bundl
fix collect node prop bundl nodepropbundl modif
node nodeid lost found lostnfoundid set node nodeid orphan set report item reportitem report
log info check bundl
skip system node root node
string tostr end endswith babecafebab
string tostr equal cafebab cafe babe cafe babecafebab
node' children
collect node prop bundl nodepropbundl child node entri childnodeentri miss children missingchildren arrai list arraylist node prop bundl nodepropbundl child node entri childnodeentri
node prop bundl nodepropbundl child node entri childnodeentri entri bundl child node entri getchildnodeentri
skip check system node root system root version storag node type
entri getid string tostr end endswith babecafebab
analyz child node bundl
node prop bundl nodepropbundl child load bundl loadbundl entri getid
string messag
child
messag nodest refer inexist child
entri getnam entri getid
log error messag
miss children missingchildren add entri
node nodeid child parent getparentid
messag childnod invalid parent null
log error messag
equal
messag childnod invalid parent
log error messag
messag
add messag addmessag report messag
item state except itemstateexcept
problem log loadbundl call logdetailederror true
add messag addmessag report messag getmessag
remov child node entri fix enabl
fix miss children missingchildren empti isempti
node prop bundl nodepropbundl child node entri childnodeentri entri miss children missingchildren
bundl child node entri getchildnodeentri remov entri
modif add bundl
check parent refer
node nodeid parent parentid bundl parent getparentid
skip root node point
parent parentid string tostr end endswith babecafebab
node prop bundl nodepropbundl parent bundl parentbundl load bundl loadbundl parent parentid
parent bundl parentbundl
string messag nodest refer inexist parent parent parentid
log error messag
add messag addmessag report messag
orphan add
lost found lostnfoundid
bundl set parent setparentid lost found lostnfoundid
modif add bundl
found
node prop bundl nodepropbundl child node entri childnodeentri entri parent bundl parentbundl child node entri getchildnodeentri
entri getid equal
found
found
string messag nodest referenc parent node parent parentid
log error messag
add messag addmessag report messag
system current time milli currenttimemilli
random int nextint
string node nodenam integ hex string tohexstr
parent bundl parentbundl add child node entri addchildnodeentri creat node nodenam
log info nodest add parent node parent parentid node nodenam
modif add parent bundl parentbundl
item state except itemstateexcept
string messag error read node parent parentid parent
log error messag
add messag addmessag report messag
add messag addmessag set report item reportitem report node nodeid string messag
report
report add report item impl reportitemimpl string tostr messag
