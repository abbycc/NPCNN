org apach jackrabbit core journal
org apach common util ioutil
org apach jackrabbit core util check schema oper checkschemaoper
org apach jackrabbit core util connect factori connectionfactori
org apach jackrabbit core util connect helper connectionhelp
org apach jackrabbit core util databas awar databaseawar
org apach jackrabbit core util util dbutil
org apach jackrabbit core util stream wrapper streamwrapp
org apach jackrabbit spi common namespac namespac resolv namespaceresolv
org slf4j logger
org slf4j logger factori loggerfactori
java buffer reader bufferedread
java byte arrai input stream bytearrayinputstream
java file
java input stream inputstream
java input stream reader inputstreamread
java sql result set resultset
java sql sql except sqlexcept
java util calendar
javax jcr repositori except repositoryexcept
javax sql data sourc datasourc
databas base journal implement store record insid databas tabl name
code journal code tabl code global revis code
highest revis number tabl locat insid schema
code schemaobjectprefix code
configur properti
code driver code jdbc driver class requir
properti default
code url code jdbc connect url requir properti
default
code databasetyp code databas type
field insid jdbc connect url delimit colon
code schemaobjectprefix code schema object prefix
default empti string
code user code usernam connect
code password code password connect
code reconnectdelaym code number millisecond wait
reconnect databas
code janitoren code specifi clean thread
journal tabl enabl default code fals code
code janitorsleep code specifi sleep time clean thread
second clean thread enabl default
equal hour
code janitorfirstrunhourofdai code specifi hour clean
thread initi run default code code mean night
code schemachecken code schema check initi enabl
default code true code
jndi connect case javax name initialcontext driver
jndi url user password configur jndi resourc
configur jndi set
pre
param driver javax name initialcontext
param url java comp env jdbc test
pre
databas journal databasejourn abstract journal abstractjourn databas awar databaseawar
default journal tabl check schema complet
string default journal tabl default journal tabl journal
local revis tabl check schema complet
string local revis tabl local revis tabl local revis
logger
logger log logger factori loggerfactori logger getlogg databas journal databasejourn
driver bean properti
string driver
connect url bean properti
string url
databas type bean properti
string databas type databasetyp
user bean properti
string user
password bean properti
string password
datasourc logic bean properti
string data sourc datasourcenam
connect helper
connect helper connectionhelp con helper conhelp
auto commit level
lock level locklevel
lock revis
lock revis lockedrevis
revis tabl janitor thread enabl
janitor enabl janitoren
sleep time revis tabl janitor second dai default
janitor sleep janitorsleep
run janitor schedul
run schedul default hour
calendar janitor run janitornextrun calendar instanc getinst
janitor run janitornextrun calendar hour dai hour dai
janitor run janitornextrun add calendar dai month dai month
janitor run janitornextrun set calendar hour dai hour dai
janitor run janitornextrun set calendar minut
janitor run janitornextrun set calendar
janitor run janitornextrun set calendar millisecond
thread janitor thread janitorthread
schema check initi
schema check enabl schemachecken
instanc manag local revis
databas revis databaserevis databas revis databaserevis
sql statement return revis rang
string select revis stmt sql selectrevisionsstmtsql
sql statement updat global revis
string updat global stmt sql updateglobalstmtsql
sql statement return global revis
string select global stmt sql selectglobalstmtsql
sql statement append record
string insert revis stmt sql insertrevisionstmtsql
sql statement return minimum local revis
string select min local revis stmt sql selectminlocalrevisionstmtsql
sql statement remov set revis journal tabl
string clean revis stmt sql cleanrevisionstmtsql
sql statement return local revis cluster node
string local revis stmt sql getlocalrevisionstmtsql
sql statement insert local revis cluster node
string insert local revis stmt sql insertlocalrevisionstmtsql
sql statement updat local revis cluster node
string updat local revis stmt sql updatelocalrevisionstmtsql
schema object prefix bean properti
string schema object prefix schemaobjectprefix
repositori link connectionfactori
connect factori connectionfactori connect factori connectionfactori
databas journal databasejourn
databas type databasetyp default
schema object prefix schemaobjectprefix
inheritdoc
set connect factori setconnectionfactori connect factori connectionfactori connnect factori connnectionfactori
connect factori connectionfactori connnect factori connnectionfactori
inheritdoc
init string namespac resolv namespaceresolv resolv
journal except journalexcept
init resolv
init
con helper conhelp creat connect helper createconnectionhelp data sourc getdatasourc
make schemaobjectprefix consist legal charact
schema object prefix schemaobjectprefix con helper conhelp prepar identifi preparedbidentifi schema object prefix schemaobjectprefix
check schema object exist creat
schema check enabl isschemachecken
creat check schema oper createcheckschemaoper run
make local revis tabl exist jcr
schema check enabl isschemachecken
check local revis schema checklocalrevisionschema
build sql statement buildsqlstat
init instanc revis janitor initinstancerevisionandjanitor
except
string msg unabl creat connect
journal except journalexcept msg
log info databasejourn initi
data sourc datasourc data sourc getdatasourc except
data sourc getdatasourcenam equal data sourc getdatasourcenam
connect factori connectionfactori data sourc getdatasourc driver getdriv url geturl user getus password getpassword
connect factori connectionfactori data sourc getdatasourc data sourc datasourcenam
method call link init string namespaceresolv method class
return link connectionhelp instanc assign code conhelp field
subclass overrid return special connect helper
param datasrc link datasourc persist manag
return link connectionhelp
throw except error
connect helper connectionhelp creat connect helper createconnectionhelp data sourc datasourc data src datasrc except
connect helper connectionhelp data src datasrc
method call link init string namespaceresolv
link createconnectionhelp datasourc method return default link checkschemaoper
subclass overrrid implement custom implement
return link checkschemaoper instanc
check schema oper checkschemaoper creat check schema oper createcheckschemaoper
input stream inputstream databas journal databasejourn resourc stream getresourceasstream databas type databasetyp ddl
check schema oper checkschemaoper con helper conhelp schema object prefix schemaobjectprefix default journal tabl default journal tabl add variabl replac addvariablereplac
check schema oper checkschemaoper schema object prefix variabl schema object prefix variabl schema object prefix schemaobjectprefix
complet initi databas journal base implement
check requir bean properti code driver code
code url code option deduc valid
databas type overridden subclass
creat connect requir argument
getconnect
throw journalexcept initi fail
init journal except journalexcept
driver data sourc datasourcenam
string msg driver
journal except journalexcept msg
url data sourc datasourcenam
string msg connect url
journal except journalexcept msg
data sourc datasourcenam
string configur databas type configureddatabasetyp connect factori connectionfactori data base type getdatabasetyp data sourc datasourcenam
databas journal databasejourn resourc stream getresourceasstream configur databas type configureddatabasetyp ddl
set databas type setdatabasetyp configur databas type configureddatabasetyp
repositori except repositoryexcept
journal except journalexcept fail databas type
databas type databasetyp
databas type databasetyp databas type url getdatabasetypefromurl url
illeg argument except illegalargumentexcept
string msg unabl deriv databas type url messag getmessag
journal except journalexcept msg
initi instanc revis manag janitor thread
throw journalexcept error
init instanc revis janitor initinstancerevisionandjanitor except
databas revis databaserevis databas revis databaserevis
local file revis disk upgrad jcr
local file revis localfilerevis
revis getrevis
instanc revis instancerevis current file revis currentfilerevis file revis filerevis file revis getrevis
local file revis localfilerevis current file revis currentfilerevis
current file revis currentfilerevis close
write localfilerevis exist local revis
tabl local revis tabl entri cluster node
local revis localrevis databas revis databaserevis init local file revis localfilerevis
log info initi local revis local revis localrevis
start clean thread
janitor enabl janitoren
janitor thread janitorthread thread revis tabl janitor revisiontablejanitor jackrabbit clusterrevisionjanitor
janitor thread janitorthread set daemon setdaemon
janitor thread janitorthread start
log info cluster revis janitor thread start run schedul janitor run janitornextrun time gettim
log info cluster revis janitor thread start
javadoc
org apach jackrabbit core journal journal getinstancerevis
instanc revis instancerevis instanc revis getinstancerevis journal except journalexcept
databas revis databaserevis
deriv databas type jdbc connect url simpli treat url
delimet colon take 2nd field
param url jdbc connect url
return databas type
throw illegalargumentexcept jdbc connect url invalid
string databas type url getdatabasetypefromurl string url illeg argument except illegalargumentexcept
start url index indexof
start
end url index indexof start
end
url substr start end
illeg argument except illegalargumentexcept url
inheritdoc
record iter recorditer record getrecord start revis startrevis journal except journalexcept
databas record iter databaserecorditer con helper conhelp exec select revis stmt sql selectrevisionsstmtsql object long
start revis startrevis resolv getresolv path resolv getnamepathresolv
sql except sqlexcept
journal except journalexcept unabl return record iter
inheritdoc
record iter recorditer record getrecord journal except journalexcept
databas record iter databaserecorditer con helper conhelp exec select revis stmt sql selectrevisionsstmtsql object long
long min min resolv getresolv path resolv getnamepathresolv
sql except sqlexcept
journal except journalexcept unabl return record iter
synchron content journal overridden subclass
overrid batchmod databas psql
transact mode load result memori
memori
param startrevis start point exclus
throw journalexcept error occur
overrid
sync dosync start revis startrevis journal except journalexcept
con helper conhelp start batch startbatch
sync dosync start revis startrevis
con helper conhelp end batch endbatch
sql except sqlexcept
journal except journalexcept sync cluster node
inheritdoc
journal lock increment current tabl
name code global revis code effect write lock
tabl updat save rememb
append record save entail multipl append jcr
lock dolock journal except journalexcept
result set resultset
succeed
lock level locklevel
con helper conhelp start batch startbatch
sql except sqlexcept
journal except journalexcept unabl set autocommit fals
con helper conhelp exec updat global stmt sql updateglobalstmtsql
con helper conhelp exec select global stmt sql selectglobalstmtsql
journal except journalexcept revis
lock revis lockedrevis long getlong
succeed
sql except sqlexcept
journal except journalexcept unabl lock global revis tabl
util dbutil close
succeed
unlock dounlock
inheritdoc
unlock dounlock success
lock level locklevel
con helper conhelp end batch endbatch success
sql except sqlexcept
log error fail end batch
inheritdoc
save lock revis insid newli append record
append append record appendrecord record
record set revis setrevis lock revis lockedrevis
inheritdoc
save revis record
append append record appendrecord record input stream inputstream length
journal except journalexcept
con helper conhelp exec insert revis stmt sql insertrevisionstmtsql record revis getrevis getid record produc getproducerid
stream wrapper streamwrapp length
sql except sqlexcept
string msg unabl append revis lock revis lockedrevis
journal except journalexcept msg
inheritdoc
close
janitor thread janitorthread
janitor thread janitorthread interrupt
check local revis schema object exist creat
exist
throw except error occur
check local revis schema checklocalrevisionschema except
input stream inputstream local revis ddl stream localrevisionddlstream
input stream inputstream databas journal databasejourn resourc stream getresourceasstream databas type databasetyp ddl
buffer reader bufferedread reader buffer reader bufferedread input stream reader inputstreamread
string sql reader read line readlin
sql
skip comment empti line select statement creat local revis
tabl
sql start startswith sql length sql index indexof local revis tabl local revis tabl
local revis ddl stream localrevisionddlstream byte arrai input stream bytearrayinputstream sql byte getbyt
read sql stmt
sql reader read line readlin
util ioutil close quietli closequietli
run schema check singl tabl
check schema oper checkschemaoper con helper conhelp local revis ddl stream localrevisionddlstream schema object prefix schemaobjectprefix
local revis tabl local revis tabl add variabl replac addvariablereplac
check schema oper checkschemaoper schema object prefix variabl schema object prefix variabl schema object prefix schemaobjectprefix run
build sql statement overridden subclass
tabl column name
build sql statement buildsqlstat
select revis stmt sql selectrevisionsstmtsql
select revis journal produc revis data
schema object prefix schemaobjectprefix journal revis order revis
updat global stmt sql updateglobalstmtsql
updat schema object prefix schemaobjectprefix global revis
set revis revis
select global stmt sql selectglobalstmtsql
select revis
schema object prefix schemaobjectprefix global revis
insert revis stmt sql insertrevisionstmtsql
insert schema object prefix schemaobjectprefix journal
revis journal produc revis data
valu
select min local revis stmt sql selectminlocalrevisionstmtsql
select min revis schema object prefix schemaobjectprefix local revis
clean revis stmt sql cleanrevisionstmtsql
delet schema object prefix schemaobjectprefix journal revis
local revis stmt sql getlocalrevisionstmtsql
select revis schema object prefix schemaobjectprefix local revis
journal
insert local revis stmt sql insertlocalrevisionstmtsql
insert schema object prefix schemaobjectprefix local revis
revis journal valu
updat local revis stmt sql updatelocalrevisionstmtsql
updat schema object prefix schemaobjectprefix local revis
set revis journal
bean getter
string driver getdriv
driver
string url geturl
url
databas type
return databas type
string databas type getdatabasetyp
databas type databasetyp
databas type
deprec
method deprec link getdatabasetyp
return databas type
string schema getschema
databas type databasetyp
string schema object prefix getschemaobjectprefix
schema object prefix schemaobjectprefix
string user getus
user
string password getpassword
password
janitor enabl getjanitoren
janitor enabl janitoren
janitor sleep getjanitorsleep
janitor sleep janitorsleep
janitor run hour dai getjanitorfirstrunhourofdai
janitor run janitornextrun calendar hour dai hour dai
bean setter
set driver setdriv string driver
driver driver
set url seturl string url
url url
set databas type
param databasetyp databas type
set databas type setdatabasetyp string databas type databasetyp
databas type databasetyp databas type databasetyp
set databas type
deprec
method deprec link getdatabasetyp
param databasetyp databas type
set schema setschema string databas type databasetyp
databas type databasetyp databas type databasetyp
set schema object prefix setschemaobjectprefix string schema object prefix schemaobjectprefix
schema object prefix schemaobjectprefix schema object prefix schemaobjectprefix upper case touppercas
set user setus string user
user user
set password setpassword string password
password password
set janitor enabl setjanitoren enabl
janitor enabl janitoren enabl
set janitor sleep setjanitorsleep sleep
janitor sleep janitorsleep sleep
set janitor run hour dai setjanitorfirstrunhourofdai hour dai hourofdai
janitor run janitornextrun calendar instanc getinst
janitor run janitornextrun calendar hour dai hour dai hour dai hourofdai
janitor run janitornextrun add calendar dai month dai month
janitor run janitornextrun set calendar hour dai hour dai hour dai hourofdai
janitor run janitornextrun set calendar minut
janitor run janitornextrun set calendar
janitor run janitornextrun set calendar millisecond
string data sourc getdatasourcenam
data sourc datasourcenam
set data sourc setdatasourcenam string data sourc datasourcenam
data sourc datasourcenam data sourc datasourcenam
return schema check enabl
schema check enabl isschemachecken
schema check enabl schemachecken
param enabl set schema check enabl
set schema check enabl setschemachecken enabl
schema check enabl schemachecken enabl
class manag local revis cluster node
persist local revis local revis tabl
cluster databas
databas revis databaserevis instanc revis instancerevis
cach local revis cluster node
local revis localrevis
init method call
initi
check local revis databas
cluster node write default revis databas
param revis default local revis counter
return local revis
throw journalexcept error
init revis journal except journalexcept
result set resultset
check entri databas
con helper conhelp exec local revis stmt sql getlocalrevisionstmtsql object getid
exist
exist
revis long getlong
insert revis databas
exist
con helper conhelp exec insert local revis stmt sql insertlocalrevisionstmtsql revis getid
set cach local revis return
local revis localrevis revis
initi
revis
sql except sqlexcept
log warn fail initi local revis
journal except journalexcept fail initi local revis
util dbutil close
inheritdoc
initi
illeg state except illegalstateexcept instanc initi
local revis localrevis
inheritdoc
set local revis localrevis journal except journalexcept
initi
illeg state except illegalstateexcept instanc initi
updat cach tabl local revis
con helper conhelp exec updat local revis stmt sql updatelocalrevisionstmtsql local revis localrevis getid
local revis localrevis local revis localrevis
sql except sqlexcept
log warn fail updat local revis
journal except journalexcept fail updat local revis
inheritdoc
close
class maintain revis tabl
inform search index databas node type
case revis data safe thrown journal tabl
revis tabl janitor revisiontablejanitor runnabl
inheritdoc
run
thread current thread currentthread interrupt isinterrupt
log info clean run schedul janitor run janitornextrun time gettim
sleep time sleeptim janitor run janitornextrun time milli gettimeinmilli system current time milli currenttimemilli
sleep time sleeptim
thread sleep sleep time sleeptim
clean revis cleanupoldrevis
janitor run janitornextrun add calendar janitor sleep janitorsleep
interrupt except interruptedexcept
thread current thread currentthread interrupt
log info interrupt stop clean task
clean revis cluster tabl
clean revis cleanupoldrevis
result set resultset
min revis minrevis
con helper conhelp exec select min local revis stmt sql selectminlocalrevisionstmtsql
clean cleanup
clean cleanup
min revis minrevis long getlong
clean
clean cleanup
con helper conhelp exec clean revis stmt sql cleanrevisionstmtsql min revis minrevis
log info clean revis revis min revis minrevis
except
log warn fail clean revis
util dbutil close
